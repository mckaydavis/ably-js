[4mRunning "concat:ably" (concat) task[24m
File browser/static/ably.js created.

[4mRunning "concat:ably.noencryption" (concat) task[24m
File browser/static/ably.noencryption.js created.

[4mRunning "concat:ably-commonjs" (concat) task[24m
File browser/static/ably-commonjs.js created.

[4mRunning "concat:ably-reactnative" (concat) task[24m
File browser/static/ably-reactnative.js created.

[4mRunning "concat:ably-nativescript" (concat) task[24m
File browser/static/ably-nativescript.js created.

[4mRunning "concat:ably-commonjs.noencryption" (concat) task[24m
File browser/static/ably-commonjs.noencryption.js created.

[4mRunning "concat:ably.d.ts" (concat) task[24m
File browser/static/ably.d.ts created.

[4mRunning "requirejs" task[24m

[4mRunning "nodeunit" task[24m
Running Nodeunit test suite against all tests
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]

[1mauth.test.js[22m
Test App _tmp_a2l_MQ in environment sandbox has been set up
âœ” setupauth
16:18:39.494 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:18:39.609 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:39.610 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authbase0
16:18:39.844 Ably: Connection state: connecting
16:18:40.99 Ably: Connection state: connected
16:18:40.103 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:40.107 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” auth_useAuthUrl_json
16:18:40.222 Ably: Connection state: connecting
16:18:40.555 Ably: Connection state: connected
16:18:40.556 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:40.556 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” auth_useAuthUrl_post_json
16:18:40.666 Ably: Connection state: connecting
16:18:40.784 Ably: Connection state: connected
16:18:40.784 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:40.785 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” auth_useAuthUrl_plainText
16:18:40.797 Ably: Connection state: connecting
16:18:40.958 Ably: Connection state: connected
16:18:40.958 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:40.959 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” auth_useAuthCallback_tokenRequestResponse
16:18:40.973 Ably: Connection state: connecting
16:18:41.131 Ably: Connection state: connected
16:18:41.131 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:41.131 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” auth_useAuthCallback_tokenDetailsResponse
16:18:41.148 Ably: Connection state: connecting
16:18:41.300 Ably: Connection state: connected
16:18:41.300 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:41.301 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” auth_useAuthCallback_tokenStringResponse
16:18:41.313 Ably: Connection state: connecting
16:18:41.489 Ably: Connection state: connected
16:18:41.490 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:41.490 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_clientid_inheritance
16:18:41.588 Ably: Connection state: connecting
16:18:41.589 Ably: Connection state: failed; reason: Mismatch between clientId in token (test client id) and current clientId (WRONG), code: 40102
16:18:41.589 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:41.590 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_clientid_inheritance2
16:18:41.684 Ably: Connection state: connecting
16:18:41.964 Ably: Connection state: connected
16:18:41.964 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:41.965 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_clientid_inheritance3
16:18:42.62 Ably: Connection state: connecting
16:18:42.153 Ably: Connection state: connected
16:18:42.153 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.154 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_clientid_inheritance4
16:18:42.251 Ably: Connection state: connecting
16:18:42.324 Ably: Connection state: connected
16:18:42.325 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.325 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” auth_clientid_inheritance5
16:18:42.336 Ably: Connection state: connecting
16:18:42.337 Ably: Auth.requestToken(): token request signing call returned error; err = Error: An error from client code that the authCallback might return
16:18:42.338 Ably: Connection state: disconnected; reason: Error: An error from client code that the authCallback might return, code: 80019
No transport established; closing connection and calling test.done()
16:18:42.338 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.338 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authCallback_error
16:18:42.340 Ably: Connection state: connecting
16:18:42.442 Ably: Auth.requestToken(): Token request callback timed out after 0.1 seconds
16:18:42.442 Ably: Connection state: disconnected; reason: Token request callback timed out after 0.1 seconds, code: 80019
No transport established; closing connection and calling test.done()
16:18:42.443 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.443 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authCallback_timeout
16:18:42.443 Ably: Connection state: connecting
16:18:42.444 Ably: Auth.requestToken(): Expected token request callback to call back with a token string or token request/details object, but got a undefined
16:18:42.444 Ably: Connection state: disconnected; reason: Expected token request callback to call back with a token string or token request/details object, but got a undefined, code: 80019
No transport established; closing connection and calling test.done()
16:18:42.444 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.444 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authCallback_nothing
16:18:42.444 Ably: Connection state: connecting
16:18:42.445 Ably: Auth.requestToken(): Expected token request callback to call back with a token string, token request object, or token details object
16:18:42.445 Ably: Connection state: disconnected; reason: Expected token request callback to call back with a token string, token request object, or token details object, code: 80019
No transport established; closing connection and calling test.done()
16:18:42.445 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.445 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authCallback_malformed
16:18:42.446 Ably: Connection state: connecting
16:18:42.446 Ably: Connection state: disconnected; reason: Token string exceeded max permitted length (was 390 bytes), code: 80019
No transport established; closing connection and calling test.done()
16:18:42.446 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.446 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authCallback_too_long_string
16:18:42.447 Ably: Connection state: connecting
16:18:42.551 Ably: Auth.requestToken(): Token request callback timed out after 0.1 seconds
16:18:42.552 Ably: Connection state: disconnected; reason: Token request callback timed out after 0.1 seconds, code: 80019
No transport established; closing connection and calling test.done()
16:18:42.552 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.552 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authUrl_timeout
16:18:42.554 Ably: Connection state: connecting
16:18:42.734 Ably: Auth.requestToken(): token request signing call returned error; err = { statusCode: 404, code: undefined, message: undefined }
16:18:42.735 Ably: Connection state: disconnected; reason: { statusCode: 404, code: undefined, message: undefined }, code: 80019
No transport established; closing connection and calling test.done()
16:18:42.735 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.735 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authUrl_404
16:18:42.735 Ably: Connection state: connecting
16:18:42.821 Ably: Auth.requestToken(): token request signing call returned error; err = [ErrorInfo: authUrl responded with unacceptable content-type text/html, should be either text/plain or application/json; statusCode=401; code=40170]
16:18:42.822 Ably: Connection state: disconnected; reason: authUrl responded with unacceptable content-type text/html, should be either text/plain or application/json, code: 80019
No transport established; closing connection and calling test.done()
16:18:42.822 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:42.822 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authUrl_wrong_content_type
16:18:42.922 Ably: Connection state: connecting
16:18:43.13 Ably: Connection state: connected
16:18:47.914 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:18:47.915 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:18:47.915 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:18:47.916 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:18:47.916 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:47.916 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_web_socket_binary_transport
16:18:48.32 Ably: Connection state: connecting
16:18:48.120 Ably: Connection state: connected
16:18:53.31 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:18:53.32 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:18:53.32 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:18:53.32 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:18:53.32 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:53.32 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_web_socket_text_transport
16:18:53.130 Ably: Connection state: connecting
16:18:53.241 Ably: Connection state: connected
16:18:58.141 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:18:58.143 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:18:58.143 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:18:58.143 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:18:58.143 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:18:58.143 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_comet_binary_transport
16:18:58.243 Ably: Connection state: connecting
16:18:58.346 Ably: Connection state: connected
16:19:3.239 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:3.240 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:19:3.241 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:19:3.241 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:19:3.241 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:3.241 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_comet_text_transport
16:19:3.370 Ably: Connection state: connecting
16:19:3.476 Ably: Connection state: connected
16:19:8.361 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:8.362 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:19:8.362 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:19:8.362 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:19:8.362 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:8.362 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_binary_transport
16:19:8.461 Ably: Connection state: connecting
16:19:8.577 Ably: Connection state: connected
16:19:13.458 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:13.459 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:19:13.459 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:19:13.459 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:19:13.459 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:13.460 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_text_transport
âœ” auth_query_time_once
16:19:13.481 Ably: Connection state: connecting
16:19:13.746 Ably: Connection state: connected
16:19:18.692 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:18.694 Ably: Connection state: connecting
16:19:18.849 Ably: Connection state: connected
16:19:18.849 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:18.849 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_tokenDetails_expiry_with_authcallback_with_web_socket_binary_transport
16:19:18.850 Ably: Connection state: connecting
16:19:19.3 Ably: Connection state: connected
16:19:23.952 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:23.953 Ably: Connection state: connecting
16:19:24.128 Ably: Connection state: connected
16:19:24.129 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:24.129 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_tokenDetails_expiry_with_authcallback_with_web_socket_text_transport
16:19:24.131 Ably: Connection state: connecting
16:19:24.313 Ably: Connection state: connected
16:19:29.233 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:29.234 Ably: Connection state: connecting
16:19:29.414 Ably: Connection state: connected
16:19:29.415 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:29.416 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_tokenDetails_expiry_with_authcallback_with_comet_binary_transport
16:19:29.417 Ably: Connection state: connecting
16:19:29.587 Ably: Connection state: connected
16:19:34.514 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:34.515 Ably: Connection state: connecting
16:19:34.809 Ably: Connection state: connected
16:19:34.809 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:34.810 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_tokenDetails_expiry_with_authcallback_with_comet_text_transport
16:19:34.811 Ably: Connection state: connecting
16:19:35.37 Ably: Connection state: connected
16:19:39.956 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:39.957 Ably: Connection state: connecting
16:19:40.174 Ably: Connection state: connected
16:19:40.175 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:40.175 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_tokenDetails_expiry_with_authcallback_with_binary_transport
16:19:40.176 Ably: Connection state: connecting
16:19:40.356 Ably: Connection state: connected
16:19:45.317 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:45.318 Ably: Connection state: connecting
16:19:45.556 Ably: Connection state: connected
16:19:45.556 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:45.558 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_tokenDetails_expiry_with_authcallback_with_text_transport
16:19:45.560 Ably: Connection state: connecting
16:19:45.794 Ably: Connection state: connected
16:19:50.650 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:50.650 Ably: Connection state: connecting
16:19:50.807 Ably: Connection state: connected
16:19:50.807 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:50.807 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_authcallback_with_web_socket_binary_transport
16:19:50.808 Ably: Connection state: connecting
16:19:50.971 Ably: Connection state: connected
16:19:55.924 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:19:55.924 Ably: Connection state: connecting
16:19:56.81 Ably: Connection state: connected
16:19:56.82 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:19:56.82 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_authcallback_with_web_socket_text_transport
16:19:56.84 Ably: Connection state: connecting
16:19:56.273 Ably: Connection state: connected
16:20:1.184 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:1.184 Ably: Connection state: connecting
16:20:1.458 Ably: Connection state: connected
16:20:1.459 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:1.459 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_authcallback_with_comet_binary_transport
16:20:1.462 Ably: Connection state: connecting
16:20:1.677 Ably: Connection state: connected
16:20:6.554 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:6.554 Ably: Connection state: connecting
16:20:6.743 Ably: Connection state: connected
16:20:6.743 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:6.744 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_authcallback_with_comet_text_transport
16:20:6.745 Ably: Connection state: connecting
16:20:6.926 Ably: Connection state: connected
16:20:11.838 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:11.838 Ably: Connection state: connecting
16:20:12.2 Ably: Connection state: connected
16:20:12.2 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:12.3 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_authcallback_with_binary_transport
16:20:12.3 Ably: Connection state: connecting
16:20:12.184 Ably: Connection state: connected
16:20:17.116 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:17.117 Ably: Connection state: connecting
16:20:17.373 Ably: Connection state: connected
16:20:17.373 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:17.373 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_authcallback_with_text_transport
16:20:17.492 Ably: Connection state: connecting
16:20:17.633 Ably: Connection state: connected
16:20:22.476 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:22.478 Ably: Connection state: connecting
16:20:22.478 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:22.478 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:22.479 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:22.479 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_token_with_web_socket_binary_transport
16:20:22.578 Ably: Connection state: connecting
16:20:22.641 Ably: Connection state: connected
16:20:27.571 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:27.571 Ably: Connection state: connecting
16:20:27.571 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:27.571 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:27.572 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:27.573 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_token_with_web_socket_text_transport
16:20:27.668 Ably: Connection state: connecting
16:20:27.761 Ably: Connection state: connected
16:20:32.674 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:32.675 Ably: Connection state: connecting
16:20:32.675 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:32.675 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:32.675 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:32.675 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_token_with_comet_binary_transport
16:20:32.774 Ably: Connection state: connecting
16:20:32.859 Ably: Connection state: connected
16:20:37.772 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:37.772 Ably: Connection state: connecting
16:20:37.772 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:37.772 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:37.773 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:37.773 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_token_with_comet_text_transport
16:20:37.871 Ably: Connection state: connecting
16:20:37.958 Ably: Connection state: connected
16:20:42.869 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:42.869 Ably: Connection state: connecting
16:20:42.870 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:42.870 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:42.870 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:42.870 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_token_with_binary_transport
16:20:42.970 Ably: Connection state: connecting
16:20:43.70 Ably: Connection state: connected
16:20:47.975 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:20:47.975 Ably: Connection state: connecting
16:20:47.976 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:47.976 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:47.976 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:47.976 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_string_expiry_with_token_with_text_transport
16:20:48.173 Ably: Connection state: connecting
16:20:48.233 Ably: Connection state: disconnected; reason: Token expired, code: 40142
16:20:48.234 Ably: Connection state: connecting
16:20:48.234 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:48.234 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:48.234 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:48.235 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_expired_token_string_with_web_socket_binary_transport
16:20:48.434 Ably: Connection state: connecting
16:20:48.522 Ably: Connection state: disconnected; reason: Token expired, code: 40142
16:20:48.522 Ably: Connection state: connecting
16:20:48.522 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:48.522 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:48.523 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:48.523 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_expired_token_string_with_web_socket_text_transport
16:20:48.719 Ably: Connection state: connecting
16:20:48.792 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:48.792 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:48.793 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:48.793 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_expired_token_string_with_comet_binary_transport
16:20:48.989 Ably: Connection state: connecting
16:20:49.55 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:49.55 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:49.55 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:49.55 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_expired_token_string_with_comet_text_transport
16:20:49.251 Ably: Connection state: connecting
16:20:49.319 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:49.319 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:49.320 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:49.320 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_expired_token_string_with_binary_transport
16:20:49.518 Ably: Connection state: connecting
16:20:49.606 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:20:49.606 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:20:49.606 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:49.606 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_expired_token_string_with_text_transport
16:20:49.607 Ably: Connection state: connecting
16:20:49.768 Ably: Connection state: connected
16:20:49.770 Ably: Channel state for channel "right": attaching
16:20:49.784 Ably: Channel state for channel "right": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = right; statusCode=401; code=40160]
16:20:49.897 Ably: Channel state for channel "right": attaching
16:20:50.652 Ably: Channel state for channel "right": attached
16:20:50.653 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:50.653 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:50.654 Ably: Channel state for channel "right": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” reauth_authCallback_with_web_socket_binary_transport
16:20:50.666 Ably: Connection state: connecting
16:20:50.818 Ably: Connection state: connected
16:20:50.819 Ably: Channel state for channel "right": attaching
16:20:50.831 Ably: Channel state for channel "right": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = right; statusCode=401; code=40160]
16:20:50.941 Ably: Channel state for channel "right": attaching
16:20:50.962 Ably: Channel state for channel "right": attached
16:20:50.962 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:50.963 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:50.963 Ably: Channel state for channel "right": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” reauth_authCallback_with_web_socket_text_transport
16:20:50.977 Ably: Connection state: connecting
16:20:51.160 Ably: Connection state: connected
16:20:51.161 Ably: Channel state for channel "right": attaching
16:20:51.228 Ably: Channel state for channel "right": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = right; statusCode=401; code=40160]
16:20:51.346 Ably: Channel state for channel "right": attaching
16:20:51.379 Ably: Channel state for channel "right": attached
16:20:51.379 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:51.379 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:51.379 Ably: Channel state for channel "right": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” reauth_authCallback_with_comet_binary_transport
16:20:51.380 Ably: Connection state: connecting
16:20:51.562 Ably: Connection state: connected
16:20:51.562 Ably: Channel state for channel "right": attaching
16:20:51.636 Ably: Channel state for channel "right": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = right; statusCode=401; code=40160]
16:20:51.755 Ably: Channel state for channel "right": attaching
16:20:51.780 Ably: Channel state for channel "right": attached
16:20:51.781 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:51.782 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:51.783 Ably: Channel state for channel "right": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” reauth_authCallback_with_comet_text_transport
16:20:51.784 Ably: Connection state: connecting
16:20:51.972 Ably: Connection state: connected
16:20:51.972 Ably: Channel state for channel "right": attaching
16:20:52.30 Ably: Channel state for channel "right": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = right; statusCode=401; code=40160]
16:20:52.144 Ably: Channel state for channel "right": attaching
16:20:52.166 Ably: Channel state for channel "right": attached
16:20:52.167 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:52.167 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:52.167 Ably: Channel state for channel "right": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” reauth_authCallback_with_binary_transport
16:20:52.182 Ably: Connection state: connecting
16:20:52.363 Ably: Connection state: connected
16:20:52.363 Ably: Channel state for channel "right": attaching
16:20:52.435 Ably: Channel state for channel "right": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = right; statusCode=401; code=40160]
16:20:52.545 Ably: Channel state for channel "right": attaching
16:20:52.558 Ably: Channel state for channel "right": attached
16:20:52.559 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:52.559 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:52.559 Ably: Channel state for channel "right": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” reauth_authCallback_with_text_transport
16:20:52.573 Ably: Connection state: connecting
16:20:52.576 Ably: Auth.authorize: Deprecation warning: specifying {force: true} in authOptions is no longer necessary, authorize() now always gets a new token. Please remove this, as in version 1.0 and later, having a non-null authOptions will overwrite stored library authOptions, which may not be what you want
No transport established; closing connection and calling test.done()
16:20:52.578 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:52.578 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” authorize_updates_stored_details
16:20:52.584 Ably: Connection state: connecting
16:20:52.640 Ably: Auth.requestToken(): token request signing call returned error; err = Error: getaddrinfo ENOTFOUND invalid invalid:80
16:20:52.641 Ably: Auth.requestToken(): token request signing call returned error; err = Error: getaddrinfo ENOTFOUND invalid invalid:80
16:20:52.649 Ably: WebSocketTransport.onError(): Unexpected error from WebSocket: unexpected server response (401)
16:20:52.741 Ably: Connection state: connected
16:20:52.837 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:52.838 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” mocked_reauth
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]

[1mchannel.test.js[22m
âœ” setupchannel
16:20:52.866 Ably: Connection state: connecting
16:20:52.948 Ably: Connection state: connected
16:20:52.948 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:52.949 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelinit0_with_web_socket_binary_transport
16:20:52.963 Ably: Connection state: connecting
16:20:53.21 Ably: Connection state: connected
16:20:53.21 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:53.22 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelinit0_with_web_socket_text_transport
16:20:53.35 Ably: Connection state: connecting
16:20:53.117 Ably: Connection state: connected
16:20:53.117 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:53.118 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelinit0_with_comet_binary_transport
16:20:53.120 Ably: Connection state: connecting
16:20:53.203 Ably: Connection state: connected
16:20:53.203 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:53.205 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelinit0_with_comet_text_transport
16:20:53.206 Ably: Connection state: connecting
16:20:53.291 Ably: Connection state: connected
16:20:53.294 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:53.298 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelinit0_with_binary_transport
16:20:53.299 Ably: Connection state: connecting
16:20:53.406 Ably: Connection state: connected
16:20:53.408 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:53.409 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelinit0_with_text_transport
16:20:53.410 Ably: Connection state: connecting
16:20:53.486 Ably: Connection state: connected
16:20:53.486 Ably: Channel state for channel "channelattach0": attaching
16:20:53.822 Ably: Channel state for channel "channelattach0": attached
16:20:53.822 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:53.822 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:53.823 Ably: Channel state for channel "channelattach0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach0_with_web_socket_binary_transport
16:20:53.835 Ably: Connection state: connecting
16:20:53.908 Ably: Connection state: connected
16:20:53.908 Ably: Channel state for channel "channelattach0": attaching
16:20:53.922 Ably: Channel state for channel "channelattach0": attached
16:20:53.922 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:53.922 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:53.922 Ably: Channel state for channel "channelattach0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach0_with_web_socket_text_transport
16:20:53.936 Ably: Connection state: connecting
16:20:54.21 Ably: Connection state: connected
16:20:54.21 Ably: Channel state for channel "channelattach0": attaching
16:20:54.91 Ably: Channel state for channel "channelattach0": attached
16:20:54.91 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:54.92 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:54.92 Ably: Channel state for channel "channelattach0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach0_with_comet_binary_transport
16:20:54.95 Ably: Connection state: connecting
16:20:54.188 Ably: Connection state: connected
16:20:54.189 Ably: Channel state for channel "channelattach0": attaching
16:20:54.257 Ably: Channel state for channel "channelattach0": attached
16:20:54.257 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:54.258 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:54.258 Ably: Channel state for channel "channelattach0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach0_with_comet_text_transport
16:20:54.259 Ably: Connection state: connecting
16:20:54.344 Ably: Connection state: connected
16:20:54.344 Ably: Channel state for channel "channelattach0": attaching
16:20:54.413 Ably: Channel state for channel "channelattach0": attached
16:20:54.413 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:54.414 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:54.414 Ably: Channel state for channel "channelattach0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach0_with_binary_transport
16:20:54.415 Ably: Connection state: connecting
16:20:54.502 Ably: Connection state: connected
16:20:54.502 Ably: Channel state for channel "channelattach0": attaching
16:20:54.591 Ably: Channel state for channel "channelattach0": attached
16:20:54.591 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:54.591 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:54.592 Ably: Channel state for channel "channelattach0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach0_with_text_transport
16:20:54.593 Ably: Connection state: connecting
16:20:54.593 Ably: Channel state for channel "channelattach2": attaching
16:20:54.663 Ably: Connection state: connected
16:20:54.972 Ably: Channel state for channel "channelattach2": attached
16:20:54.973 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:54.973 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:54.973 Ably: Channel state for channel "channelattach2": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach2_with_web_socket_binary_transport
16:20:54.986 Ably: Connection state: connecting
16:20:54.986 Ably: Channel state for channel "channelattach2": attaching
16:20:55.67 Ably: Connection state: connected
16:20:55.79 Ably: Channel state for channel "channelattach2": attached
16:20:55.79 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:55.80 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:55.80 Ably: Channel state for channel "channelattach2": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach2_with_web_socket_text_transport
16:20:55.92 Ably: Connection state: connecting
16:20:55.92 Ably: Channel state for channel "channelattach2": attaching
16:20:55.173 Ably: Connection state: connected
16:20:55.251 Ably: Channel state for channel "channelattach2": attached
16:20:55.252 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:55.252 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:55.252 Ably: Channel state for channel "channelattach2": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach2_with_comet_binary_transport
16:20:55.253 Ably: Connection state: connecting
16:20:55.253 Ably: Channel state for channel "channelattach2": attaching
16:20:55.344 Ably: Connection state: connected
16:20:55.423 Ably: Channel state for channel "channelattach2": attached
16:20:55.423 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:55.423 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:55.423 Ably: Channel state for channel "channelattach2": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach2_with_comet_text_transport
16:20:55.424 Ably: Connection state: connecting
16:20:55.424 Ably: Channel state for channel "channelattach2": attaching
16:20:55.513 Ably: Connection state: connected
16:20:55.582 Ably: Channel state for channel "channelattach2": attached
16:20:55.582 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:55.583 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:55.583 Ably: Channel state for channel "channelattach2": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach2_with_binary_transport
16:20:55.583 Ably: Connection state: connecting
16:20:55.584 Ably: Channel state for channel "channelattach2": attaching
16:20:55.679 Ably: Connection state: connected
16:20:55.748 Ably: Channel state for channel "channelattach2": attached
16:20:55.749 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:55.749 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:20:55.749 Ably: Channel state for channel "channelattach2": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach2_with_text_transport
16:20:55.751 Ably: Connection state: connecting
16:20:55.835 Ably: Connection state: connected
16:20:55.836 Ably: Channel state for channel "channelattach3": attaching
16:20:56.22 Ably: Channel state for channel "channelattach3": attached
16:20:56.23 Ably: Channel state for channel "channelattach3": detaching
16:20:56.38 Ably: Channel state for channel "channelattach3": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:20:56.38 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:56.38 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach3_with_web_socket_binary_transport
16:20:56.52 Ably: Connection state: connecting
16:20:56.126 Ably: Connection state: connected
16:20:56.127 Ably: Channel state for channel "channelattach3": attaching
16:20:56.141 Ably: Channel state for channel "channelattach3": attached
16:20:56.141 Ably: Channel state for channel "channelattach3": detaching
16:20:56.151 Ably: Channel state for channel "channelattach3": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:20:56.151 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:56.151 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach3_with_web_socket_text_transport
16:20:56.164 Ably: Connection state: connecting
16:20:56.250 Ably: Connection state: connected
16:20:56.250 Ably: Channel state for channel "channelattach3": attaching
16:20:56.319 Ably: Channel state for channel "channelattach3": attached
16:20:56.319 Ably: Channel state for channel "channelattach3": detaching
16:20:56.342 Ably: Channel state for channel "channelattach3": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:20:56.342 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:56.343 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach3_with_comet_binary_transport
16:20:56.343 Ably: Connection state: connecting
16:20:56.443 Ably: Connection state: connected
16:20:56.444 Ably: Channel state for channel "channelattach3": attaching
16:20:56.542 Ably: Channel state for channel "channelattach3": attached
16:20:56.542 Ably: Channel state for channel "channelattach3": detaching
16:20:56.558 Ably: Channel state for channel "channelattach3": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:20:56.559 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:56.561 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach3_with_comet_text_transport
16:20:56.563 Ably: Connection state: connecting
16:20:56.639 Ably: Connection state: connected
16:20:56.640 Ably: Channel state for channel "": attaching
16:20:56.657 Ably: Channel state for channel "": failed; reason: [ErrorInfo: Invalid channel id (); statusCode=400; code=40010]
16:20:57.607 Ably: Auth.requestToken(): token request signing call returned error; err = Error: getaddrinfo ENOTFOUND invalid invalid:80
16:20:57.658 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:57.658 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachempty_with_web_socket_binary_transport
16:20:57.672 Ably: Connection state: connecting
16:20:57.741 Ably: Connection state: connected
16:20:57.741 Ably: Channel state for channel "": attaching
16:20:57.754 Ably: Channel state for channel "": failed; reason: [ErrorInfo: Invalid channel id (); statusCode=400; code=40010]
16:20:58.756 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:58.757 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachempty_with_web_socket_text_transport
16:20:58.772 Ably: Connection state: connecting
16:20:58.850 Ably: Connection state: connected
16:20:58.851 Ably: Channel state for channel "": attaching
16:20:58.907 Ably: Channel state for channel "": failed; reason: [ErrorInfo: Invalid channel id (); statusCode=400; code=40010]
16:20:59.909 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:20:59.910 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachempty_with_comet_binary_transport
16:20:59.911 Ably: Connection state: connecting
16:20:59.994 Ably: Connection state: connected
16:20:59.994 Ably: Channel state for channel "": attaching
16:21:0.57 Ably: Channel state for channel "": failed; reason: [ErrorInfo: Invalid channel id (); statusCode=400; code=40010]
16:21:1.58 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:1.59 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachempty_with_comet_text_transport
16:21:1.78 Ably: Connection state: connecting
16:21:1.163 Ably: Connection state: connected
16:21:1.163 Ably: Channel state for channel "": attaching
16:21:1.233 Ably: Channel state for channel "": failed; reason: [ErrorInfo: Invalid channel id (); statusCode=400; code=40010]
16:21:2.234 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:2.235 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachempty_with_binary_transport
16:21:2.249 Ably: Connection state: connecting
16:21:2.329 Ably: Connection state: connected
16:21:2.329 Ably: Channel state for channel "": attaching
16:21:2.383 Ably: Channel state for channel "": failed; reason: [ErrorInfo: Invalid channel id (); statusCode=400; code=40010]
16:21:3.383 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:3.384 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachempty_with_text_transport
16:21:3.398 Ably: Connection state: connecting
16:21:3.460 Ably: Connection state: connected
16:21:3.461 Ably: Channel state for channel ":hell": attaching
16:21:3.474 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:4.475 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:4.475 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachinvalid_with_web_socket_binary_transport
16:21:4.491 Ably: Connection state: connecting
16:21:4.547 Ably: Connection state: connected
16:21:4.547 Ably: Channel state for channel ":hell": attaching
16:21:4.559 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:5.561 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:5.561 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachinvalid_with_web_socket_text_transport
16:21:5.576 Ably: Connection state: connecting
16:21:5.657 Ably: Connection state: connected
16:21:5.657 Ably: Channel state for channel ":hell": attaching
16:21:5.714 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:6.716 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:6.717 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachinvalid_with_comet_binary_transport
16:21:6.718 Ably: Connection state: connecting
16:21:6.793 Ably: Connection state: connected
16:21:6.794 Ably: Channel state for channel ":hell": attaching
16:21:6.864 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:7.865 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:7.865 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachinvalid_with_comet_text_transport
16:21:7.866 Ably: Connection state: connecting
16:21:7.949 Ably: Connection state: connected
16:21:7.949 Ably: Channel state for channel ":hell": attaching
16:21:8.5 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:9.6 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:9.7 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachinvalid_with_binary_transport
16:21:9.19 Ably: Connection state: connecting
16:21:9.109 Ably: Connection state: connected
16:21:9.111 Ably: Channel state for channel ":hell": attaching
16:21:9.180 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:10.182 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:10.182 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattachinvalid_with_text_transport
16:21:10.196 Ably: Connection state: connecting
16:21:10.259 Ably: Connection state: connected
16:21:10.260 Ably: Channel state for channel "channelattach_publish": attaching
16:21:10.368 Ably: Channel state for channel "channelattach_publish": attached
16:21:10.385 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:10.385 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:10.385 Ably: Channel state for channel "channelattach_publish": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach_publish_with_web_socket_binary_transport
16:21:10.396 Ably: Connection state: connecting
16:21:10.465 Ably: Connection state: connected
16:21:10.466 Ably: Channel state for channel "channelattach_publish": attaching
16:21:10.482 Ably: Channel state for channel "channelattach_publish": attached
16:21:10.499 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:10.500 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:10.500 Ably: Channel state for channel "channelattach_publish": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach_publish_with_web_socket_text_transport
16:21:10.510 Ably: Connection state: connecting
16:21:10.594 Ably: Connection state: connected
16:21:10.595 Ably: Channel state for channel "channelattach_publish": attaching
16:21:10.681 Ably: Channel state for channel "channelattach_publish": attached
16:21:10.702 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:10.702 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:10.702 Ably: Channel state for channel "channelattach_publish": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach_publish_with_comet_binary_transport
16:21:10.704 Ably: Connection state: connecting
16:21:10.793 Ably: Connection state: connected
16:21:10.793 Ably: Channel state for channel "channelattach_publish": attaching
16:21:10.862 Ably: Channel state for channel "channelattach_publish": attached
16:21:10.892 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:10.892 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:10.892 Ably: Channel state for channel "channelattach_publish": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach_publish_with_comet_text_transport
16:21:10.893 Ably: Connection state: connecting
16:21:10.974 Ably: Connection state: connected
16:21:10.974 Ably: Channel state for channel "channelattach_publish": attaching
16:21:11.52 Ably: Channel state for channel "channelattach_publish": attached
16:21:11.84 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:11.84 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:11.84 Ably: Channel state for channel "channelattach_publish": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach_publish_with_binary_transport
16:21:11.85 Ably: Connection state: connecting
16:21:11.170 Ably: Connection state: connected
16:21:11.170 Ably: Channel state for channel "channelattach_publish": attaching
16:21:11.249 Ably: Channel state for channel "channelattach_publish": attached
16:21:11.274 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:11.274 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:11.274 Ably: Channel state for channel "channelattach_publish": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattach_publish_with_text_transport
16:21:11.275 Ably: Connection state: connecting
16:21:11.342 Ably: Connection state: connected
16:21:11.342 Ably: Channel state for channel ":hell": attaching
16:21:11.358 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:11.358 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:11.358 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_publish_invalid_with_web_socket_binary_transport
16:21:11.370 Ably: Connection state: connecting
16:21:11.441 Ably: Connection state: connected
16:21:11.441 Ably: Channel state for channel ":hell": attaching
16:21:11.461 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:11.461 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:11.462 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_publish_invalid_with_web_socket_text_transport
16:21:11.474 Ably: Connection state: connecting
16:21:11.559 Ably: Connection state: connected
16:21:11.560 Ably: Channel state for channel ":hell": attaching
16:21:11.615 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:11.615 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:11.615 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_publish_invalid_with_comet_binary_transport
16:21:11.616 Ably: Connection state: connecting
16:21:11.697 Ably: Connection state: connected
16:21:11.697 Ably: Channel state for channel ":hell": attaching
16:21:11.768 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:11.768 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:11.769 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_publish_invalid_with_comet_text_transport
16:21:11.770 Ably: Connection state: connecting
16:21:11.848 Ably: Connection state: connected
16:21:11.848 Ably: Channel state for channel ":hell": attaching
16:21:11.918 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:11.918 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:11.919 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_publish_invalid_with_binary_transport
16:21:11.920 Ably: Connection state: connecting
16:21:11.997 Ably: Connection state: connected
16:21:11.998 Ably: Channel state for channel ":hell": attaching
16:21:12.71 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:12.71 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:12.71 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_publish_invalid_with_text_transport
16:21:12.72 Ably: Connection state: connecting
16:21:12.148 Ably: Connection state: connected
16:21:12.148 Ably: Channel state for channel ":hell": attaching
16:21:12.161 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:12.161 Ably: Channel state for channel ":hell": attaching
16:21:12.175 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:13.176 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:13.176 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_invalid_twice_with_web_socket_binary_transport
16:21:13.189 Ably: Connection state: connecting
16:21:13.259 Ably: Connection state: connected
16:21:13.260 Ably: Channel state for channel ":hell": attaching
16:21:13.272 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:13.272 Ably: Channel state for channel ":hell": attaching
16:21:13.285 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:14.286 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:14.286 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_invalid_twice_with_web_socket_text_transport
16:21:14.299 Ably: Connection state: connecting
16:21:14.382 Ably: Connection state: connected
16:21:14.382 Ably: Channel state for channel ":hell": attaching
16:21:14.452 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:14.452 Ably: Channel state for channel ":hell": attaching
16:21:14.469 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:15.470 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:15.470 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_invalid_twice_with_comet_binary_transport
16:21:15.472 Ably: Connection state: connecting
16:21:15.546 Ably: Connection state: connected
16:21:15.546 Ably: Channel state for channel ":hell": attaching
16:21:15.622 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:15.623 Ably: Channel state for channel ":hell": attaching
16:21:15.653 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:16.654 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:16.655 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_invalid_twice_with_comet_text_transport
16:21:16.656 Ably: Connection state: connecting
16:21:16.750 Ably: Connection state: connected
16:21:16.750 Ably: Channel state for channel ":hell": attaching
16:21:16.817 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:16.818 Ably: Channel state for channel ":hell": attaching
16:21:16.849 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:17.851 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:17.853 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_invalid_twice_with_binary_transport
16:21:17.871 Ably: Connection state: connecting
16:21:17.954 Ably: Connection state: connected
16:21:17.954 Ably: Channel state for channel ":hell": attaching
16:21:18.22 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:18.22 Ably: Channel state for channel ":hell": attaching
16:21:18.39 Ably: Channel state for channel ":hell": failed; reason: [ErrorInfo: Invalid channel id (:hell); statusCode=400; code=40010]
16:21:19.40 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:19.41 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” channelattach_invalid_twice_with_text_transport
16:21:19.55 Ably: Connection state: connecting
16:21:19.55 Ably: Channel state for channel "channelattachOnceOrIf": attaching
16:21:19.120 Ably: Connection state: connected
16:21:19.301 Ably: Channel state for channel "channelattachOnceOrIf": attached
16:21:19.302 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:19.302 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:19.302 Ably: Channel state for channel "channelattachOnceOrIf": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattachOnceOrIfAfter
16:21:19.319 Ably: Connection state: connecting
16:21:19.319 Ably: Channel state for channel "channelattachOnceOrIf": attaching
16:21:19.372 Ably: Connection state: connected
16:21:19.388 Ably: Channel state for channel "channelattachOnceOrIf": attached
16:21:19.388 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:19.389 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:19.389 Ably: Channel state for channel "channelattachOnceOrIf": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelattachOnceOrIfBefore
16:21:19.400 Ably: Connection state: connecting
16:21:19.476 Ably: Connection state: connected
16:21:19.476 Ably: Channel state for channel "channelsubscribe0": attaching
16:21:19.703 Ably: Channel state for channel "channelsubscribe0": attached
16:21:20.706 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:20.707 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:20.707 Ably: Channel state for channel "channelsubscribe0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelsubscribe0
16:21:20.722 Ably: Connection state: connecting
16:21:20.788 Ably: Connection state: connected
16:21:20.788 Ably: Channel state for channel "channelsubscribe1-event": attaching
16:21:20.891 Ably: Channel state for channel "channelsubscribe1-event": attached
16:21:20.892 Ably: Channel state for channel "channelsubscribe1-listener": attaching
16:21:21.8 Ably: Channel state for channel "channelsubscribe1-listener": attached
16:21:21.9 Ably: Channel state for channel "channelsubscribe1-all": attaching
16:21:21.188 Ably: Channel state for channel "channelsubscribe1-all": attached
16:21:21.921 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:21.921 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:21.921 Ably: Channel state for channel "channelsubscribe1-event": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:21.921 Ably: Channel state for channel "channelsubscribe1-listener": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:21.921 Ably: Channel state for channel "channelsubscribe1-all": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channelsubscribe1
16:21:21.935 Ably: Connection state: connecting
16:21:22.11 Ably: Connection state: connected
16:21:22.11 Ably: Channel state for channel "server_sent_detached": attaching
16:21:22.192 Ably: Channel state for channel "server_sent_detached": attached
16:21:22.193 Ably: Channel state for channel "server_sent_detached": attaching; reason: [ErrorInfo: generic serverside failure; statusCode=500; code=50000]
16:21:22.294 Ably: Channel state for channel "server_sent_detached": suspended; reason: [ErrorInfo: Channel attach timed out; statusCode=408; code=90007]
16:21:22.295 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:22.295 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:22.295 Ably: Channel state for channel "server_sent_detached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” server_sent_detached
16:21:22.307 Ably: Connection state: connecting
16:21:22.381 Ably: Connection state: connected
16:21:22.381 Ably: Channel state for channel "server_sent_detached_while_attaching": attaching
16:21:22.382 Ably: Channel state for channel "server_sent_detached_while_attaching": suspended; reason: [ErrorInfo: generic serverside failure; statusCode=500; code=50000]
16:21:22.384 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:22.385 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:22.385 Ably: Channel state for channel "server_sent_detached_while_attaching": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” server_sent_detached_while_attaching
16:21:22.396 Ably: Connection state: connecting
16:21:22.457 Ably: Connection state: connected
16:21:22.457 Ably: Channel state for channel "server_sent_error": attaching
16:21:22.639 Ably: Channel state for channel "server_sent_error": attached
16:21:22.640 Ably: Channel state for channel "server_sent_error": failed; reason: [ErrorInfo: generic serverside failure; statusCode=500; code=50000]
16:21:22.640 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:22.640 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” server_sent_error
16:21:22.653 Ably: Connection state: connecting
16:21:22.725 Ably: Connection state: connected
16:21:22.725 Ably: Channel state for channel "server_sent_attached_err": attaching
16:21:22.831 Ably: Channel state for channel "server_sent_attached_err": attached
16:21:22.832 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:22.832 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:22.833 Ably: Channel state for channel "server_sent_attached_err": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” server_sent_attached_err
16:21:22.849 Ably: Connection state: connecting
16:21:22.918 Ably: Connection state: connected
16:21:22.919 Ably: Channel state for channel "publish_no_queueing": attaching
16:21:23.19 Ably: Channel state for channel "publish_no_queueing": attached
16:21:23.20 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
No transport established; closing connection and calling test.done()
16:21:23.20 Ably: Connection state: connecting
16:21:23.20 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:23.20 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:23.20 Ably: Channel state for channel "publish_no_queueing": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” publish_no_queueing
16:21:23.21 Ably: Connection state: connecting
16:21:23.77 Ably: Connection state: connected
16:21:23.78 Ably: Channel state for channel "channel_attach_timeout": attaching
16:21:23.177 Ably: Channel state for channel "channel_attach_timeout": suspended; reason: [ErrorInfo: Channel attach timed out; statusCode=408; code=90007]
16:21:23.278 Ably: Channel state for channel "channel_attach_timeout": attaching
16:21:23.279 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:23.279 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:23.279 Ably: Channel state for channel "channel_attach_timeout": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” channel_attach_timeout
16:21:23.292 Ably: Connection state: connecting
16:21:23.375 Ably: Connection state: connected
16:21:23.375 Ably: Channel state for channel "suspended_connection": attaching
16:21:23.482 Ably: Channel state for channel "suspended_connection": attached
16:21:23.482 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:21:23.482 Ably: Connection state: connecting
16:21:23.483 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:21:23.483 Ably: Channel state for channel "suspended_connection": suspended; reason: [ErrorInfo: Connection to server unavailable; statusCode=400; code=80002]
16:21:24.484 Ably: Connection state: connecting
16:21:24.545 Ably: Connection state: connected
16:21:24.546 Ably: Channel state for channel "suspended_connection": attaching
16:21:24.645 Ably: Channel state for channel "suspended_connection": suspended; reason: [ErrorInfo: Channel attach timed out; statusCode=408; code=90007]
16:21:24.646 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:24.646 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:24.647 Ably: Channel state for channel "suspended_connection": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” suspended_connection

[1mconnection.test.js[22m
âœ” setupConnection
16:21:24.664 Ably: Connection state: connecting
16:21:24.730 Ably: Connection state: connected
16:21:24.731 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:24.732 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” connectionPing
16:21:24.745 Ably: Connection state: connecting
16:21:24.801 Ably: Connection state: connected
16:21:24.815 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:24.816 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” connectionPingWithCallback
16:21:24.831 Ably: Connection state: connecting
16:21:24.891 Ably: Connection state: connected
16:21:24.891 Ably: Channel state for channel "connectionattributes": attaching
16:21:25.73 Ably: Channel state for channel "connectionattributes": attached
connectionAttributes test: connection serial is 0
16:21:25.90 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:25.90 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:25.90 Ably: Channel state for channel "connectionattributes": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
No transport established; closing connection and calling test.done()
âœ” connectionAttributes
16:21:25.91 Ably: Connection state: connecting
16:21:25.377 Ably: ConnectionManager.activateTransport(): error = [ErrorInfo: Unable to recover connection: not found (ablyjs_test_fake); statusCode=400; code=80008]
16:21:25.377 Ably: Connection state: connected; reason: Unable to recover connection: not found (ablyjs_test_fake), code: 80008
16:21:25.378 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:25.378 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” unrecoverableConnection
16:21:25.391 Ably: Connection state: connecting
16:21:25.466 Ably: Channel state for channel "connectionQueuing": attaching
16:21:25.467 Ably: Connection state: connected
16:21:25.644 Ably: Channel state for channel "connectionQueuing": attached
16:21:25.645 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:21:25.645 Ably: Connection state: connecting
16:21:25.702 Ably: Connection state: connected
16:21:25.720 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:25.720 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:25.721 Ably: Channel state for channel "connectionQueuing": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” connectionQueuing

[1mconnectivity.test.js[22m
âœ” setupConnectivity
âœ” http_connectivity_check
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]

[1mcrypto.test.js[22m
âœ” setupCrypto
âœ” generateRandomKey0
âœ” generateRandomKey1
âœ” getDefaultParams_wordArray_key
âœ” getDefaultParams_base64_key
âœ” getDefaultParams_check_keylength
âœ” getDefaultParams_preserves_custom_algorithms
16:21:25.763 Ably: Connection state: connecting
16:21:25.764 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.766 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.766 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.767 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
No transport established; closing connection and calling test.done()
16:21:25.768 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:25.769 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” encrypt_message_128
16:21:25.777 Ably: Connection state: connecting
16:21:25.777 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.778 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.778 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.778 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
No transport established; closing connection and calling test.done()
16:21:25.779 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:25.781 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” encrypt_message_256
16:21:25.782 Ably: Connection state: connecting
16:21:25.782 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.783 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.783 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.783 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
No transport established; closing connection and calling test.done()
16:21:25.784 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:25.784 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” decrypt_message_128
16:21:25.785 Ably: Connection state: connecting
16:21:25.786 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.786 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.786 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.786 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
No transport established; closing connection and calling test.done()
16:21:25.787 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:25.787 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” decrypt_message_256
16:21:25.788 Ably: Connection state: connecting
16:21:25.789 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.790 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.791 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.791 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
No transport established; closing connection and calling test.done()
16:21:25.794 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:25.794 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” msgpack_128
16:21:25.796 Ably: Connection state: connecting
16:21:25.797 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.797 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.799 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:25.799 Ably: Message.fromEncoded(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
No transport established; closing connection and calling test.done()
16:21:25.802 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:25.802 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” msgpack_256
16:21:25.804 Ably: Connection state: connecting
16:21:25.804 Ably: Channel state for channel "single_send": attaching
16:21:25.928 Ably: Connection state: connected
16:21:26.110 Ably: Channel state for channel "single_send": attached
16:21:26.127 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:26.127 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:26.127 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_128_with_web_socket_binary_transport
16:21:26.140 Ably: Connection state: connecting
16:21:26.140 Ably: Channel state for channel "single_send": attaching
16:21:26.201 Ably: Connection state: connected
16:21:26.221 Ably: Channel state for channel "single_send": attached
16:21:26.237 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:26.237 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:26.238 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_128_with_web_socket_text_transport
16:21:26.249 Ably: Connection state: connecting
16:21:26.249 Ably: Channel state for channel "single_send": attaching
16:21:26.336 Ably: Connection state: connected
16:21:26.405 Ably: Channel state for channel "single_send": attached
16:21:26.425 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:26.426 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:26.426 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_128_with_comet_binary_transport
16:21:26.427 Ably: Connection state: connecting
16:21:26.427 Ably: Channel state for channel "single_send": attaching
16:21:26.516 Ably: Connection state: connected
16:21:26.585 Ably: Channel state for channel "single_send": attached
16:21:26.616 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:26.616 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:26.616 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_128_with_comet_text_transport
16:21:26.617 Ably: Connection state: connecting
16:21:26.617 Ably: Channel state for channel "single_send": attaching
16:21:26.707 Ably: Connection state: connected
16:21:26.771 Ably: Channel state for channel "single_send": attached
16:21:26.792 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:26.792 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:26.793 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_128_with_binary_transport
16:21:26.794 Ably: Connection state: connecting
16:21:26.794 Ably: Channel state for channel "single_send": attaching
16:21:26.884 Ably: Connection state: connected
16:21:26.953 Ably: Channel state for channel "single_send": attached
16:21:26.977 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:26.977 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:26.977 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_128_with_text_transport
16:21:26.993 Ably: Connection state: connecting
16:21:26.993 Ably: Channel state for channel "single_send": attaching
16:21:27.61 Ably: Connection state: connected
16:21:27.77 Ably: Channel state for channel "single_send": attached
16:21:27.94 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:27.95 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:27.95 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_256_with_web_socket_binary_transport
16:21:27.107 Ably: Connection state: connecting
16:21:27.108 Ably: Channel state for channel "single_send": attaching
16:21:27.376 Ably: Connection state: connected
16:21:27.386 Ably: Channel state for channel "single_send": attached
16:21:27.403 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:27.403 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:27.403 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_256_with_web_socket_text_transport
16:21:27.414 Ably: Connection state: connecting
16:21:27.414 Ably: Channel state for channel "single_send": attaching
16:21:27.501 Ably: Connection state: connected
16:21:27.569 Ably: Channel state for channel "single_send": attached
16:21:27.590 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:27.591 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:27.591 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_256_with_comet_binary_transport
16:21:27.594 Ably: Connection state: connecting
16:21:27.594 Ably: Channel state for channel "single_send": attaching
16:21:27.681 Ably: Connection state: connected
16:21:27.749 Ably: Channel state for channel "single_send": attached
16:21:27.780 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:27.780 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:27.780 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_256_with_comet_text_transport
16:21:27.781 Ably: Connection state: connecting
16:21:27.781 Ably: Channel state for channel "single_send": attaching
16:21:27.868 Ably: Connection state: connected
16:21:27.926 Ably: Channel state for channel "single_send": attached
16:21:27.957 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:27.957 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:27.958 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_256_with_binary_transport
16:21:27.960 Ably: Connection state: connecting
16:21:27.960 Ably: Channel state for channel "single_send": attaching
16:21:28.48 Ably: Connection state: connected
16:21:28.117 Ably: Channel state for channel "single_send": attached
16:21:28.141 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:28.141 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:28.141 Ably: Channel state for channel "single_send": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” single_send_256_with_text_transport
16:21:28.156 Ably: Connection state: connecting
16:21:28.158 Ably: Channel state for channel "multiple_send_binary_2_200": attaching
16:21:28.221 Ably: Connection state: connected
16:21:28.405 Ably: Channel state for channel "multiple_send_binary_2_200": attached
16:21:28.424 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:28.424 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:28.424 Ably: Channel state for channel "multiple_send_binary_2_200": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” multiple_send_binary_2_200
16:21:28.437 Ably: Connection state: connecting
16:21:28.439 Ably: Channel state for channel "multiple_send_text_2_200": attaching
16:21:28.501 Ably: Connection state: connected
16:21:28.683 Ably: Channel state for channel "multiple_send_text_2_200": attached
16:21:28.700 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:28.701 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:28.701 Ably: Channel state for channel "multiple_send_text_2_200": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” multiple_send_text_2_200
16:21:28.712 Ably: Connection state: connecting
16:21:28.713 Ably: Channel state for channel "multiple_send_binary_20_100": attaching
16:21:28.777 Ably: Connection state: connected
16:21:28.884 Ably: Channel state for channel "multiple_send_binary_20_100": attached
16:21:30.647 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:30.647 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:30.647 Ably: Channel state for channel "multiple_send_binary_20_100": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” multiple_send_binary_20_100
16:21:30.660 Ably: Connection state: connecting
16:21:30.661 Ably: Channel state for channel "multiple_send_text_20_100": attaching
16:21:30.933 Ably: Connection state: connected
16:21:31.117 Ably: Channel state for channel "multiple_send_text_20_100": attached
16:21:32.587 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:32.587 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:32.587 Ably: Channel state for channel "multiple_send_text_20_100": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” multiple_send_text_20_100
16:21:32.599 Ably: Connection state: connecting
16:21:32.600 Ably: Connection state: connecting
16:21:32.605 Ably: Channel state for channel "single_send_separate_realtimes": attaching
16:21:32.605 Ably: Channel state for channel "single_send_separate_realtimes": attaching
16:21:32.663 Ably: Connection state: connected
16:21:32.678 Ably: Connection state: connected
16:21:32.764 Ably: Channel state for channel "single_send_separate_realtimes": attached
16:21:32.766 Ably: Channel state for channel "single_send_separate_realtimes": attached
16:21:32.782 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:32.782 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:32.783 Ably: Channel state for channel "single_send_separate_realtimes": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:32.783 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:32.783 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:32.783 Ably: Channel state for channel "single_send_separate_realtimes": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” single_send_binary_text
16:21:32.797 Ably: Connection state: connecting
16:21:32.797 Ably: Connection state: connecting
16:21:32.800 Ably: Channel state for channel "single_send_separate_realtimes": attaching
16:21:32.800 Ably: Channel state for channel "single_send_separate_realtimes": attaching
16:21:32.876 Ably: Connection state: connected
16:21:32.889 Ably: Channel state for channel "single_send_separate_realtimes": attached
16:21:33.71 Ably: Connection state: connected
16:21:33.84 Ably: Channel state for channel "single_send_separate_realtimes": attached
16:21:33.104 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:33.105 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:33.105 Ably: Channel state for channel "single_send_separate_realtimes": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:33.105 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:33.105 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:33.105 Ably: Channel state for channel "single_send_separate_realtimes": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” single_send_text_binary
16:21:33.122 Ably: Connection state: connecting
16:21:33.122 Ably: Connection state: connecting
16:21:33.127 Ably: Channel state for channel "publish_immediately": attaching
16:21:33.190 Ably: Connection state: connected
16:21:33.208 Ably: Connection state: connected
16:21:33.307 Ably: Channel state for channel "publish_immediately": attached
16:21:33.307 Ably: Channel state for channel "publish_immediately": attaching
16:21:33.327 Ably: Channel state for channel "publish_immediately": attached
16:21:33.343 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:33.344 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:33.344 Ably: Channel state for channel "publish_immediately": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:33.344 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:33.344 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:33.344 Ably: Channel state for channel "publish_immediately": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” publish_immediately
16:21:33.359 Ably: Connection state: connecting
16:21:33.359 Ably: Connection state: connecting
16:21:33.360 Ably: Channel state for channel "single_send_key_mismatch": attaching
16:21:33.360 Ably: Channel state for channel "single_send_key_mismatch": attaching
16:21:33.425 Ably: Connection state: connected
16:21:33.434 Ably: Connection state: connected
16:21:33.605 Ably: Channel state for channel "single_send_key_mismatch": attached
16:21:33.607 Ably: Channel state for channel "single_send_key_mismatch": attached
16:21:33.622 Ably: RealtimeChannel.onMessage(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜error:06065064:digital envelope routines:EVP_DecryptFinal_ex:bad decryptâ€™; statusCode=400; code=40013]
16:21:33.623 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:33.623 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:33.623 Ably: Channel state for channel "single_send_key_mismatch": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:33.624 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:33.624 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:33.624 Ably: Channel state for channel "single_send_key_mismatch": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” single_send_key_mismatch
16:21:33.638 Ably: Connection state: connecting
16:21:33.638 Ably: Connection state: connecting
16:21:33.638 Ably: Channel state for channel "single_send_unencrypted": attaching
16:21:33.638 Ably: Channel state for channel "single_send_unencrypted": attaching
16:21:33.703 Ably: Connection state: connected
16:21:33.708 Ably: Connection state: connected
16:21:33.883 Ably: Channel state for channel "single_send_unencrypted": attached
16:21:33.884 Ably: Channel state for channel "single_send_unencrypted": attached
16:21:33.901 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:33.901 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:33.902 Ably: Channel state for channel "single_send_unencrypted": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:33.902 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:33.902 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:33.902 Ably: Channel state for channel "single_send_unencrypted": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” single_send_unencrypted
16:21:33.919 Ably: Connection state: connecting
16:21:33.919 Ably: Connection state: connecting
16:21:33.919 Ably: Channel state for channel "single_send_encrypted_unhandled": attaching
16:21:33.919 Ably: Channel state for channel "single_send_encrypted_unhandled": attaching
16:21:33.985 Ably: Connection state: connected
16:21:33.991 Ably: Connection state: connected
16:21:34.91 Ably: Channel state for channel "single_send_encrypted_unhandled": attached
16:21:34.95 Ably: Channel state for channel "single_send_encrypted_unhandled": attached
16:21:34.112 Ably: RealtimeChannel.onMessage(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:34.113 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:34.113 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:34.113 Ably: Channel state for channel "single_send_encrypted_unhandled": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:34.113 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:34.113 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:34.113 Ably: Channel state for channel "single_send_encrypted_unhandled": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” single_send_encrypted_unhandled
16:21:34.128 Ably: Connection state: connecting
16:21:34.128 Ably: Connection state: connecting
16:21:34.128 Ably: Channel state for channel "set_cipher_params": attaching
16:21:34.129 Ably: Channel state for channel "set_cipher_params": attaching
16:21:34.190 Ably: Connection state: connected
16:21:34.206 Ably: Connection state: connected
16:21:34.291 Ably: Channel state for channel "set_cipher_params": attached
16:21:34.293 Ably: Channel state for channel "set_cipher_params": attached
16:21:34.323 Ably: RealtimeChannel.onMessage(): [ErrorInfo: Error processing the cipher encoding, decoder returned â€˜Unable to decrypt message; not an encrypted channelâ€™; statusCode=400; code=40013]
16:21:34.338 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:34.338 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:34.338 Ably: Channel state for channel "set_cipher_params": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:34.338 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:34.340 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:34.340 Ably: Channel state for channel "set_cipher_params": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” set_cipher_params0

[1mencoding.test.js[22m
âœ” setupEncoding
16:21:34.373 Ably: Connection state: connecting
16:21:34.373 Ably: Connection state: connecting
16:21:34.374 Ably: Channel state for channel "message_decoding": attaching
16:21:34.374 Ably: Channel state for channel "message_decoding": attaching
16:21:34.435 Ably: Connection state: connected
16:21:34.449 Ably: Connection state: connected
16:21:34.535 Ably: Channel state for channel "message_decoding": attached
16:21:34.537 Ably: Channel state for channel "message_decoding": attached
16:21:39.623 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:39.623 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:39.623 Ably: Channel state for channel "message_decoding": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:39.623 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:39.624 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:39.624 Ably: Channel state for channel "message_decoding": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” message_decoding
16:21:39.639 Ably: Connection state: connecting
16:21:39.640 Ably: Connection state: connecting
16:21:39.640 Ably: Channel state for channel "message_encoding": attaching
16:21:39.640 Ably: Channel state for channel "message_encoding": attaching
16:21:39.703 Ably: Connection state: connected
16:21:39.718 Ably: Connection state: connected
16:21:39.886 Ably: Channel state for channel "message_encoding": attached
16:21:39.888 Ably: Channel state for channel "message_encoding": attached
16:21:40.463 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.463 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:40.463 Ably: Channel state for channel "message_encoding": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:21:40.463 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.463 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:40.464 Ably: Channel state for channel "message_encoding": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” message_encoding

[1mevent_emitter.test.js[22m
âœ” setupauth
16:21:40.483 Ably: Connection state: connecting
16:21:40.549 Ably: Connection state: connected
16:21:40.550 Ably: Channel state for channel "channel": attaching
16:21:40.653 Ably: Channel state for channel "channel": attached
16:21:40.653 Ably: Channel state for channel "channel": detaching
16:21:40.668 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:21:40.668 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.668 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” attachdetach0
16:21:40.669 Ably: EventEmitter.emit(): Unexpected listener exception: Expected failure 1; stack = undefined
16:21:40.670 Ably: EventEmitter.emit(): Unexpected listener exception: Expected failure 2; stack = undefined
No transport established; closing connection and calling test.done()
16:21:40.670 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.670 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” emitCallsAllCallbacksIgnoringExceptions
No transport established; closing connection and calling test.done()
16:21:40.671 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.671 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” onceCalledOnlyOnce
No transport established; closing connection and calling test.done()
16:21:40.672 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.672 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” onceCallbackDoesNotImpactOnCallback
No transport established; closing connection and calling test.done()
16:21:40.672 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.672 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” offRemovesAllMatchingListeners
No transport established; closing connection and calling test.done()
16:21:40.673 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.673 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” offRemovesAllListeners
No transport established; closing connection and calling test.done()
16:21:40.674 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.674 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” offRemovesAllMatchingEventListeners
No transport established; closing connection and calling test.done()
16:21:40.675 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.675 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” offRemovesAllMatchingEvents
No transport established; closing connection and calling test.done()
16:21:40.675 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.675 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” offRemovesEmptyEventNameListeners
No transport established; closing connection and calling test.done()
16:21:40.676 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.677 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” arrayOfEvents
No transport established; closing connection and calling test.done()
16:21:40.677 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.677 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” listenerAddedInListenerCb
No transport established; closing connection and calling test.done()
16:21:40.678 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:40.678 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” listenerRemovedInListenerCb

[1mfailure.test.js[22m
âœ” setupFailure
16:21:40.682 Ably: Connection state: connecting
16:21:40.683 Ably: Connection state: connecting
16:21:40.683 Ably: Connection state: connecting
16:21:40.857 Ably: Connection state: failed; reason: No application found with id this, code: 40400
16:21:40.858 Ably: Connection state: failed; reason: No application found with id this, code: 40400
16:21:40.873 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1008
16:21:45.861 Ably: Connection state: failed; reason: No application found with id this, code: 40400
No transport established; closing connection and calling test.done()
No transport established; closing connection and calling test.done()
No transport established; closing connection and calling test.done()
16:21:45.862 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:45.862 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:45.862 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:45.862 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:45.862 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:45.862 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” invalid_cred_failure
16:21:45.863 Ably: Connection state: connecting
16:21:45.863 Ably: Connection state: connecting
16:21:45.863 Ably: Connection state: connecting
16:21:45.872 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1008
16:21:45.938 Ably: Connection state: connected
16:21:45.938 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:21:45.956 Ably: Connection state: connected
16:21:45.956 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:21:50.951 Ably: Connection state: connected
16:21:50.951 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
No transport established; closing connection and calling test.done()
No transport established; closing connection and calling test.done()
16:21:50.952 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:50.952 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:50.952 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:50.952 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:50.952 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:50.952 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” break_transport
16:21:50.965 Ably: Connection state: connecting
16:21:50.965 Ably: Connection state: connecting
16:21:50.965 Ably: Connection state: connecting
16:21:50.980 Ably: WebSocketTransport.onError(): Unexpected error from WebSocket: getaddrinfo ENOTFOUND invalid invalid:443
16:21:50.980 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1006
16:21:50.981 Ably: Connection state: disconnected; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:50.983 Ably: Connection state: disconnected; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:51.68 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:21:51.981 Ably: Connection state: connecting
16:21:51.984 Ably: Connection state: connecting
16:21:51.994 Ably: WebSocketTransport.onError(): Unexpected error from WebSocket: getaddrinfo ENOTFOUND invalid invalid:443
16:21:51.995 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1006
16:21:51.995 Ably: Connection state: disconnected; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:51.998 Ably: Connection state: disconnected; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:52.68 Ably: Connection state: connecting
16:21:52.90 Ably: WebSocketTransport.onError(): Unexpected error from WebSocket: getaddrinfo ENOTFOUND invalid invalid:443
16:21:52.90 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1006
16:21:52.90 Ably: Connection state: disconnected; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:52.994 Ably: Connection state: connecting
16:21:52.999 Ably: Connection state: connecting
16:21:53.8 Ably: WebSocketTransport.onError(): Unexpected error from WebSocket: getaddrinfo ENOTFOUND invalid invalid:443
16:21:53.8 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1006
16:21:53.8 Ably: Connection state: disconnected; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:53.11 Ably: Connection state: disconnected; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:53.90 Ably: Connection state: connecting
16:21:53.103 Ably: WebSocketTransport.onError(): Unexpected error from WebSocket: getaddrinfo ENOTFOUND invalid invalid:443
16:21:53.103 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1006
16:21:53.103 Ably: Connection state: disconnected; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:53.866 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:21:53.866 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:21:53.868 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:21:54.867 Ably: Connection state: connecting
16:21:54.867 Ably: Connection state: connecting
16:21:54.870 Ably: Connection state: connecting
16:21:54.889 Ably: WebSocketTransport.onError(): Unexpected error from WebSocket: getaddrinfo ENOTFOUND invalid invalid:443
16:21:54.889 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1006
16:21:54.889 Ably: Connection state: suspended; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:54.899 Ably: Connection state: suspended; reason: Unable to connect (and no more fallback hosts to try), code: 80000
16:21:54.972 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
No transport established; closing connection and calling test.done()
No transport established; closing connection and calling test.done()
No transport established; closing connection and calling test.done()
16:21:55.766 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:55.766 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:55.766 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:55.766 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:55.766 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:55.766 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” no_connection_lifecycle
16:21:55.767 Ably: Connection state: connecting
16:21:55.828 Ably: Connection state: connected
16:21:55.829 Ably: Channel state for channel "::": attaching
16:21:55.843 Ably: Channel state for channel "::": failed; reason: [ErrorInfo: Invalid channel id (::); statusCode=400; code=40010]
16:21:55.845 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:55.845 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” failed_channel
16:21:55.864 Ably: Connection state: connecting
16:21:55.926 Ably: Connection state: connected
16:21:55.927 Ably: Channel state for channel "failed_attach": attaching
16:21:55.936 Ably: Channel state for channel "failed_attach": suspended; reason: [ErrorInfo: Channel attach timed out; statusCode=408; code=90007]
16:21:55.947 Ably: Channel state for channel "failed_attach": attaching
16:21:55.947 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:55.948 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:55.948 Ably: Channel state for channel "failed_attach": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” attach_timeout
16:21:55.961 Ably: Connection state: connecting
16:21:55.993 Ably: WebSocketTransport.onError(): Unexpected error from WebSocket: getaddrinfo ENOTFOUND invalid invalid:443
16:21:56.42 Ably: Connection state: connected
16:21:56.42 Ably: Channel state for channel "nack_on_connection_failure": attaching
16:21:56.225 Ably: Channel state for channel "nack_on_connection_failure": attached
16:21:56.232 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:21:56.232 Ably: Connection state: connecting
16:21:56.232 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:21:56.232 Ably: Channel state for channel "nack_on_connection_failure": suspended; reason: [ErrorInfo: Connection to server unavailable; statusCode=400; code=80002]
No transport established; closing connection and calling test.done()
16:21:56.233 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:56.233 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:56.233 Ably: Channel state for channel "nack_on_connection_failure": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” nack_on_connection_suspended
16:21:56.234 Ably: Connection state: connecting
16:21:56.315 Ably: Connection state: connected
16:21:56.315 Ably: Channel state for channel "nack_on_connection_failure": attaching
16:21:56.336 Ably: Channel state for channel "nack_on_connection_failure": attached
16:21:56.337 Ably: Connection state: failed; reason: connection failed because reasons, code: 40100
16:21:56.337 Ably: Channel state for channel "nack_on_connection_failure": failed; reason: [object Object]
No transport established; closing connection and calling test.done()
16:21:56.338 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:56.338 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” nack_on_connection_failed
16:21:56.338 Ably: Connection state: connecting
16:21:56.448 Ably: Connection state: connected
16:21:56.452 Ably: Channel state for channel "nack_on_connection_failure": attaching
16:21:56.470 Ably: Channel state for channel "nack_on_connection_failure": attached
16:21:56.470 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:56.471 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:56.471 Ably: Channel state for channel "nack_on_connection_failure": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
No transport established; closing connection and calling test.done()
âœ” nack_on_connection_closed
16:21:56.472 Ably: Connection state: connecting
16:21:56.563 Ably: Connection state: connected
16:21:56.763 Ably: Transport.resetIdleTimeout(): No activity seen from realtime in 200ms; assuming connection has dropped
16:21:56.763 Ably: Connection state: disconnected; reason: No activity seen from realtime in 200ms; assuming connection has dropped, code: 80003
16:21:56.763 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:21:56.766 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:56.766 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” idle_transport_timeout

[1mhistory.test.js[22m
âœ” setup_realtime_history
16:21:56.771 Ably: Connection state: connecting
16:21:56.939 Ably: Connection state: connected
16:21:56.941 Ably: Channel state for channel "persisted:history_until_attach": attaching
16:21:56.955 Ably: Channel state for channel "persisted:history_until_attach": attached
16:21:57.260 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:57.261 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:21:57.261 Ably: Channel state for channel "persisted:history_until_attach": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” history_until_attach

[1minit.test.js[22m
âœ” setupInit
16:21:57.276 Ably: Connection state: connecting
16:21:57.343 Ably: Connection state: connected
16:21:57.344 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:57.344 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” initbase0
16:21:57.361 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:21:57.363 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:57.365 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” init_key_string
16:21:57.475 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:21:57.476 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:57.476 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” init_token_string
16:21:57.477 Ably: Connection state: connecting
16:21:58.81 Ably: Connection state: connected
16:21:58.81 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:58.81 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” init_key_with_usetokenauth
16:21:58.95 Ably: Connection state: connecting
16:21:58.282 Ably: Connection state: connected
16:21:58.282 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:58.282 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” init_usetokenauth_defaulttokenparams_wildcard
16:21:58.296 Ably: Connection state: connecting
16:21:58.492 Ably: Connection state: connected
16:21:58.493 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:58.493 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” init_defaulttokenparams_nonwildcard
16:21:58.506 Ably: Connection state: connecting
16:21:58.678 Ably: Connection state: connected
16:21:58.679 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:58.679 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” init_conflicting_clientids
16:21:58.691 Ably: Auth(): Cannot authenticate with basic auth as a clientId implies token auth
âœ” init_with_usetokenauth_false_and_a_clientid
16:21:58.692 Ably: Connection state: connecting
16:21:59.164 Ably: Connection state: failed; reason: No application found with id not_a, code: 40400
16:21:59.165 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:59.165 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” init_defaulthost
16:21:59.165 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:21:59.167 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:21:59.167 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” init_timeouts
16:21:59.169 Ably: Connection state: connecting
TypeError: Cannot read property 'checkConnectivity' of undefined
    at tryFallbackHosts (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:1080:69)
    at hostAttemptCb (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:1055:6)
    at ConnectionManager.realtime.connection.connectionManager.tryATransport (/mnt/terra/home/simon/ably/ably-js/spec/realtime/init.test.js:239:7)
    at ConnectionManager.connectBase (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:1099:8)
    at ConnectionManager.connectImpl (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:988:9)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:926:10
    at /mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:207:4
    at decideMode (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:202:4)
    at ConnectionManager.getTransportParams (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:205:3)
    at connect (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:925:9)
16:21:59.174 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1008
16:21:59.902 Ably: WebSocketTransport.onError(): Unexpected error from WebSocket: getaddrinfo ENOTFOUND invalid invalid:443
16:22:15.169 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
No transport established; closing connection and calling test.done()
16:22:15.170 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:15.170 Ably: Connection state: closed; reason: Connection closed, code: 80017
[31mâœ– init_fallbacks[39m

Assertion Message: [35mExpected error code after no fallback host works[39m
AssertionError: 80003 == 80000
    at Object.equal (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/realtime/init.test.js:251:10)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at Connection.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/client/connection.js:19:10
    at _combinedTickCallback (internal/process/next_tick.js:67:7)
    at process._tickCallback (internal/process/next_tick.js:98:9)

Error: Expected 6 assertions, 4 ran
    at Object.done (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:121:25)
    at Object.test.done (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:143:22)
    at /mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:50:47
    at /mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:76:6
    at _combinedTickCallback (internal/process/next_tick.js:67:7)
    at process._tickCallback (internal/process/next_tick.js:98:9)

16:22:15.172 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:22:15.174 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:15.174 Ably: Connection state: closed; reason: Connection closed, code: 80017
[31mâœ– node_transports[39m

AssertionError: 'web_socket' == 'comet'
    at Object.equal (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at exports.node_transports (/mnt/terra/home/simon/ably/ably-js/spec/realtime/init.test.js:268:10)
    at Object.exports.(anonymous function) (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:150:8)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/core.js:236:16)
    at /mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/core.js:236:16
    at Object.exports.runTest (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/core.js:70:9)
    at /mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/core.js:118:25
    at /mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/deps/async.js:513:13
    at iterate (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/deps/async.js:123:13)
    at /mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/deps/async.js:134:25
    at /mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/deps/async.js:515:17
    at Immediate.<anonymous> (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:146:17)
    at runCallback (timers.js:637:20)
    at tryOnImmediate (timers.js:610:5)
    at processImmediate [as _immediateCallback] (timers.js:582:5)

16:22:15.175 Ably: Connection state: connecting
16:22:15.561 Ably: Connection state: connected
16:22:15.561 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:15.561 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” init_and_connection_details
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]

[1mmessage.test.js[22m
âœ” setupMessage
16:22:15.568 Ably: Connection state: connecting
16:22:15.624 Ably: Connection state: connected
16:22:15.625 Ably: Channel state for channel "publishonce": attaching
16:22:15.727 Ably: Channel state for channel "publishonce": attached
16:22:15.751 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:15.751 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:15.751 Ably: Channel state for channel "publishonce": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishonce
16:22:15.764 Ably: Connection state: connecting
16:22:15.823 Ably: Connection state: connected
16:22:15.823 Ably: Channel state for channel "publishfast_2831452620473376": attaching
16:22:16.9 Ably: Channel state for channel "publishfast_2831452620473376": attached
16:22:16.528 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:16.529 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:16.529 Ably: Channel state for channel "publishfast_2831452620473376": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishfast_with_web_socket_binary_transport
16:22:16.541 Ably: Connection state: connecting
16:22:16.606 Ably: Connection state: connected
16:22:16.607 Ably: Channel state for channel "publishfast_03067754244934462": attaching
16:22:16.789 Ably: Channel state for channel "publishfast_03067754244934462": attached
16:22:17.305 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:17.306 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:17.306 Ably: Channel state for channel "publishfast_03067754244934462": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishfast_with_web_socket_text_transport
16:22:17.320 Ably: Connection state: connecting
16:22:17.404 Ably: Connection state: connected
16:22:17.404 Ably: Channel state for channel "publishfast_5397688903724389": attaching
16:22:17.673 Ably: Channel state for channel "publishfast_5397688903724389": attached
16:22:17.824 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:17.825 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:17.825 Ably: Channel state for channel "publishfast_5397688903724389": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishfast_with_comet_binary_transport
16:22:17.826 Ably: Connection state: connecting
16:22:17.912 Ably: Connection state: connected
16:22:17.912 Ably: Channel state for channel "publishfast_23338423933649644": attaching
16:22:18.130 Ably: Channel state for channel "publishfast_23338423933649644": attached
16:22:18.286 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:18.287 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:18.287 Ably: Channel state for channel "publishfast_23338423933649644": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishfast_with_comet_text_transport
16:22:18.288 Ably: Connection state: connecting
16:22:18.389 Ably: Connection state: connected
16:22:18.389 Ably: Channel state for channel "publishfast_883167913259634": attaching
16:22:18.538 Ably: Channel state for channel "publishfast_883167913259634": attached
16:22:19.74 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:19.74 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:19.74 Ably: Channel state for channel "publishfast_883167913259634": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishfast_with_binary_transport
16:22:19.87 Ably: Connection state: connecting
16:22:19.169 Ably: Connection state: connected
16:22:19.169 Ably: Channel state for channel "publishfast_6516721036820305": attaching
16:22:19.318 Ably: Channel state for channel "publishfast_6516721036820305": attached
16:22:19.852 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:19.852 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:19.852 Ably: Channel state for channel "publishfast_6516721036820305": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishfast_with_text_transport
16:22:19.867 Ably: Channel state for channel "publishQueued_44679253764468996": attaching
16:22:19.867 Ably: Connection state: connecting
16:22:19.925 Ably: Connection state: connected
16:22:20.29 Ably: Channel state for channel "publishQueued_44679253764468996": attached
16:22:21.59 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:21.59 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:21.59 Ably: Channel state for channel "publishQueued_44679253764468996": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishQueued_with_web_socket_binary_transport
16:22:21.73 Ably: Channel state for channel "publishQueued_06964040020021511": attaching
16:22:21.73 Ably: Connection state: connecting
16:22:21.127 Ably: Connection state: connected
16:22:21.230 Ably: Channel state for channel "publishQueued_06964040020021511": attached
16:22:22.264 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:22.264 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:22.264 Ably: Channel state for channel "publishQueued_06964040020021511": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishQueued_with_web_socket_text_transport
16:22:22.276 Ably: Channel state for channel "publishQueued_4464879036059961": attaching
16:22:22.276 Ably: Connection state: connecting
16:22:22.367 Ably: Connection state: connected
16:22:22.596 Ably: Channel state for channel "publishQueued_4464879036059961": attached
16:22:23.306 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:23.307 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:23.307 Ably: Channel state for channel "publishQueued_4464879036059961": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishQueued_with_comet_binary_transport
16:22:23.308 Ably: Channel state for channel "publishQueued_23107614314804636": attaching
16:22:23.308 Ably: Connection state: connecting
16:22:23.402 Ably: Connection state: connected
16:22:23.550 Ably: Channel state for channel "publishQueued_23107614314804636": attached
16:22:24.321 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:24.321 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:24.321 Ably: Channel state for channel "publishQueued_23107614314804636": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishQueued_with_comet_text_transport
16:22:24.324 Ably: Channel state for channel "publishQueued_9447946749971639": attaching
16:22:24.325 Ably: Connection state: connecting
16:22:24.404 Ably: Connection state: connected
16:22:24.563 Ably: Channel state for channel "publishQueued_9447946749971639": attached
16:22:25.617 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:25.618 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:25.618 Ably: Channel state for channel "publishQueued_9447946749971639": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishQueued_with_binary_transport
16:22:25.632 Ably: Channel state for channel "publishQueued_7638473453751491": attaching
16:22:25.632 Ably: Connection state: connecting
16:22:25.727 Ably: Connection state: connected
16:22:25.887 Ably: Channel state for channel "publishQueued_7638473453751491": attached
16:22:26.940 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:26.940 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:26.940 Ably: Channel state for channel "publishQueued_7638473453751491": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishQueued_with_text_transport
16:22:26.955 Ably: Connection state: connecting
16:22:26.955 Ably: Connection state: connecting
16:22:26.955 Ably: Channel state for channel "publishecho": attaching
16:22:27.14 Ably: Connection state: connected
16:22:27.17 Ably: Connection state: connected
16:22:27.193 Ably: Channel state for channel "publishecho": attached
16:22:27.194 Ably: Channel state for channel "publishecho": attaching
16:22:27.214 Ably: Channel state for channel "publishecho": attached
16:22:27.253 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:27.254 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:27.254 Ably: Channel state for channel "publishecho": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:27.254 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:27.254 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:27.254 Ably: Channel state for channel "publishecho": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” publishEcho
16:22:27.269 Ably: Connection state: connecting
16:22:27.339 Ably: Connection state: connected
16:22:27.340 Ably: Channel state for channel "publishVariations": attaching
16:22:27.522 Ably: Channel state for channel "publishVariations": attached
16:22:29.821 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:29.822 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:29.822 Ably: Channel state for channel "publishVariations": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishVariations
16:22:29.835 Ably: Connection state: connecting
16:22:29.893 Ably: Connection state: connected
16:22:29.893 Ably: Channel state for channel "publishDisallowed": attaching
16:22:29.996 Ably: Channel state for channel "publishDisallowed": attached
16:22:29.997 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:29.998 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:29.998 Ably: Channel state for channel "publishDisallowed": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishDisallowed
16:22:30.10 Ably: Connection state: connecting
16:22:30.69 Ably: Connection state: connected
16:22:30.70 Ably: Channel state for channel "publishEncodings": attaching
16:22:30.247 Ably: Channel state for channel "publishEncodings": attached
16:22:30.301 Ably: RealtimeChannel.onMessage(): [ErrorInfo: Error processing the utf-8 encoding, decoder returned â€˜Expected input of utf8Decode to be a buffer or CryptoJS WordArrayâ€™; statusCode=400; code=40013]
16:22:30.341 Ably: RealtimeChannel.onMessage(): [ErrorInfo: Error processing the choahofhpxf encoding, decoder returned â€˜Unknown encodingâ€™; statusCode=400; code=40013]
16:22:30.342 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:30.342 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:30.342 Ably: Channel state for channel "publishEncodings": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishEncodings
16:22:30.356 Ably: Connection state: connecting
16:22:30.356 Ably: Channel state for channel "restpublish": attaching
16:22:30.413 Ably: Connection state: connected
16:22:30.595 Ably: Channel state for channel "restpublish": attached
16:22:35.387 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:35.388 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:35.388 Ably: Channel state for channel "restpublish": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” restpublish
16:22:35.403 Ably: Connection state: connecting
16:22:35.403 Ably: Channel state for channel "publish {"transports":["web_socket"],"useBinaryProtocol":true}": attaching
sending: undefined
sending: undefined
16:22:35.464 Ably: Connection state: connected
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
16:22:35.648 Ably: Channel state for channel "publish {"transports":["web_socket"],"useBinaryProtocol":true}": attached
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
16:22:35.674 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:35.674 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:35.674 Ably: Channel state for channel "publish {"transports":["web_socket"],"useBinaryProtocol":true}": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publish_with_web_socket_binary_transport
16:22:35.687 Ably: Connection state: connecting
16:22:35.687 Ably: Channel state for channel "publish {"transports":["web_socket"],"useBinaryProtocol":false}": attaching
sending: undefined
sending: undefined
sending: undefined
16:22:35.757 Ably: Connection state: connected
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
16:22:35.942 Ably: Channel state for channel "publish {"transports":["web_socket"],"useBinaryProtocol":false}": attached
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
16:22:35.967 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:35.968 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:35.968 Ably: Channel state for channel "publish {"transports":["web_socket"],"useBinaryProtocol":false}": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publish_with_web_socket_text_transport
16:22:35.981 Ably: Connection state: connecting
16:22:35.981 Ably: Channel state for channel "publish {"transports":["comet"],"useBinaryProtocol":true}": attaching
sending: undefined
sending: undefined
sending: undefined
sending: undefined
16:22:36.67 Ably: Connection state: connected
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
16:22:36.325 Ably: Channel state for channel "publish {"transports":["comet"],"useBinaryProtocol":true}": attached
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
16:22:36.366 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:36.367 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:36.367 Ably: Channel state for channel "publish {"transports":["comet"],"useBinaryProtocol":true}": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publish_with_comet_binary_transport
16:22:36.367 Ably: Connection state: connecting
16:22:36.368 Ably: Channel state for channel "publish {"transports":["comet"],"useBinaryProtocol":false}": attaching
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
16:22:36.673 Ably: Connection state: connected
16:22:36.902 Ably: Channel state for channel "publish {"transports":["comet"],"useBinaryProtocol":false}": attached
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
16:22:36.956 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:36.957 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:36.957 Ably: Channel state for channel "publish {"transports":["comet"],"useBinaryProtocol":false}": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publish_with_comet_text_transport
16:22:36.959 Ably: Connection state: connecting
16:22:36.959 Ably: Channel state for channel "publish {"transports":["web_socket","comet"],"useBinaryProtocol":true}": attaching
sending: undefined
sending: undefined
sending: undefined
sending: undefined
16:22:37.48 Ably: Connection state: connected
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
16:22:37.207 Ably: Channel state for channel "publish {"transports":["web_socket","comet"],"useBinaryProtocol":true}": attached
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
16:22:37.234 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:37.234 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:37.234 Ably: Channel state for channel "publish {"transports":["web_socket","comet"],"useBinaryProtocol":true}": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publish_with_binary_transport
16:22:37.250 Ably: Connection state: connecting
16:22:37.251 Ably: Channel state for channel "publish {"transports":["web_socket","comet"],"useBinaryProtocol":false}": attaching
sending: undefined
sending: undefined
sending: undefined
16:22:37.327 Ably: Connection state: connected
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
sending: undefined
16:22:37.506 Ably: Channel state for channel "publish {"transports":["web_socket","comet"],"useBinaryProtocol":false}": attached
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
publish callback called
16:22:37.536 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:37.536 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:37.536 Ably: Channel state for channel "publish {"transports":["web_socket","comet"],"useBinaryProtocol":false}": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publish_with_text_transport
16:22:37.538 Ably: Connection state: connecting
16:22:37.697 Ably: Connection state: connected
16:22:37.698 Ably: Channel state for channel "implicit_client_id_0": attaching
16:22:37.886 Ably: Channel state for channel "implicit_client_id_0": attached
16:22:37.900 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:37.903 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:37.903 Ably: Channel state for channel "implicit_client_id_0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” implicit_client_id_0
16:22:37.918 Ably: Connection state: connecting
16:22:38.101 Ably: Connection state: connected
16:22:38.102 Ably: Channel state for channel "explicit_client_id_0": attaching
16:22:38.204 Ably: Channel state for channel "explicit_client_id_0": attached
16:22:38.220 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:38.221 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:38.221 Ably: Channel state for channel "explicit_client_id_0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” explicit_client_id_0
16:22:38.334 Ably: Connection state: connecting
16:22:38.334 Ably: Channel state for channel "explicit_client_id_1": attaching
16:22:38.405 Ably: Connection state: connected
16:22:38.589 Ably: Channel state for channel "explicit_client_id_1": attached
16:22:38.603 Ably: Protocol.onNack(): serial = 0; count = 1; err = [ErrorInfo: Malformed message; mismatched clientId; statusCode=400; code=40012]
16:22:39.104 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:39.104 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:39.104 Ably: Channel state for channel "explicit_client_id_1": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” explicit_client_id_1
16:22:39.119 Ably: Connection state: connecting
16:22:39.187 Ably: Connection state: connected
16:22:39.187 Ably: Channel state for channel "subscribe_with_event_array": attaching
16:22:39.373 Ably: Channel state for channel "subscribe_with_event_array": attached
16:22:39.393 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:39.393 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:39.394 Ably: Channel state for channel "subscribe_with_event_array": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” subscribe_with_event_array
16:22:39.408 Ably: Connection state: connecting
16:22:39.499 Ably: Connection state: connected
16:22:39.499 Ably: Channel state for channel "extras_field": attaching
16:22:39.682 Ably: Channel state for channel "extras_field": attached
16:22:39.703 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:39.703 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:39.703 Ably: Channel state for channel "extras_field": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” extras_field

[1mpresence.test.js[22m
âœ” setupPresence
âœ” setupPresenceTokens
16:22:39.932 Ably: Connection state: connecting
16:22:40.9 Ably: Connection state: connected
Listener connected
16:22:40.9 Ably: Channel state for channel "attachAndEnter": attaching
16:22:40.191 Ably: Channel state for channel "attachAndEnter": attached
Listener attached to channel attachAndEnter
presenceChannel: attachAndEnter
16:22:40.192 Ably: Connection state: connecting
16:22:40.247 Ably: Connection state: connected
16:22:40.247 Ably: Channel state for channel "attachAndEnter": attaching
16:22:40.267 Ably: Channel state for channel "attachAndEnter": attached
in callback, err =  null
16:22:40.287 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:40.288 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:40.288 Ably: Channel state for channel "attachAndEnter": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:40.288 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:40.288 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:40.288 Ably: Channel state for channel "attachAndEnter": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceAttachAndEnter
16:22:40.302 Ably: Connection state: connecting
16:22:40.363 Ably: Connection state: connected
Listener connected
16:22:40.363 Ably: Channel state for channel "enterWithoutAttach": attaching
16:22:40.466 Ably: Channel state for channel "enterWithoutAttach": attached
Listener attached to channel enterWithoutAttach
presenceChannel: enterWithoutAttach
16:22:40.467 Ably: Connection state: connecting
16:22:40.528 Ably: Connection state: connected
16:22:40.528 Ably: Channel state for channel "enterWithoutAttach": attaching
16:22:40.548 Ably: Channel state for channel "enterWithoutAttach": attached
in callback, err =  null
16:22:40.567 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:40.567 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:40.567 Ably: Channel state for channel "enterWithoutAttach": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:40.567 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:40.567 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:40.567 Ably: Channel state for channel "enterWithoutAttach": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterWithoutAttach
16:22:40.584 Ably: Connection state: connecting
16:22:40.653 Ably: Connection state: connected
Listener connected
16:22:40.654 Ably: Channel state for channel "enterWithoutConnect": attaching
16:22:40.759 Ably: Channel state for channel "enterWithoutConnect": attached
Listener attached to channel enterWithoutConnect
presenceChannel: enterWithoutConnect
16:22:40.759 Ably: Connection state: connecting
16:22:40.760 Ably: Channel state for channel "enterWithoutConnect": attaching
16:22:40.815 Ably: Connection state: connected
16:22:40.833 Ably: Channel state for channel "enterWithoutConnect": attached
in callback, err =  null
16:22:40.852 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:40.852 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:40.852 Ably: Channel state for channel "enterWithoutConnect": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:40.852 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:40.852 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:40.852 Ably: Channel state for channel "enterWithoutConnect": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterWithoutConnect
16:22:40.867 Ably: Connection state: connecting
16:22:40.923 Ably: Connection state: connected
Listener connected
16:22:40.923 Ably: Channel state for channel "enterDetachRace": attaching
16:22:41.104 Ably: Channel state for channel "enterDetachRace": attached
Listener attached to channel enterDetachRace
16:22:41.105 Ably: Connection state: connecting
16:22:41.173 Ably: Connection state: connected
16:22:41.174 Ably: Channel state for channel "enterDetachRace": attaching
16:22:41.191 Ably: Channel state for channel "enterDetachRace": attached
16:22:41.192 Ably: Channel state for channel "enterDetachRace": detaching
16:22:41.206 Ably: Channel state for channel "enterDetachRace": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:22:41.209 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:41.210 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:41.210 Ably: Channel state for channel "enterDetachRace": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:41.210 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:41.210 Ably: Connection state: closed; reason: Connection closed, code: 80017
No transport established; closing connection and calling test.done()
No transport established; closing connection and calling test.done()
âœ” presenceEnterDetachRace
16:22:41.211 Ably: Connection state: connecting
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterDetachRace
16:22:41.226 Ably: Connection state: connecting
16:22:41.265 Ably: Connection state: connected
Listener connected
16:22:41.266 Ably: Channel state for channel "enterWithCallback": attaching
16:22:41.289 Ably: Connection state: connected
Listener connected
16:22:41.289 Ably: Channel state for channel "enterWithNothing": attaching
16:22:41.446 Ably: Channel state for channel "enterWithCallback": attached
Listener attached to channel enterWithCallback
presenceChannel: enterWithCallback
16:22:41.447 Ably: Connection state: connecting
16:22:41.471 Ably: Channel state for channel "enterWithNothing": attached
Listener attached to channel enterWithNothing
presenceChannel: enterWithNothing
16:22:41.472 Ably: Connection state: connecting
16:22:41.505 Ably: Connection state: connected
16:22:41.505 Ably: Channel state for channel "enterWithCallback": attaching
16:22:41.520 Ably: Channel state for channel "enterWithCallback": attached
16:22:41.530 Ably: Connection state: connected
16:22:41.531 Ably: Channel state for channel "enterWithNothing": attaching
in callback, err =  null
16:22:41.537 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:41.538 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:41.538 Ably: Channel state for channel "enterWithCallback": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:41.538 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:41.538 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:41.538 Ably: Channel state for channel "enterWithCallback": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:41.544 Ably: Channel state for channel "enterWithNothing": attached
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterWithCallback
16:22:41.555 Ably: Connection state: connecting
in callback, err =  null
16:22:41.562 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:41.563 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:41.563 Ably: Channel state for channel "enterWithNothing": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:41.563 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:41.563 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:41.563 Ably: Channel state for channel "enterWithNothing": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterWithNothing
16:22:41.579 Ably: Connection state: connecting
16:22:41.579 Ably: Channel state for channel "presenceMessageAction": attaching
16:22:41.611 Ably: Connection state: connected
Listener connected
16:22:41.612 Ably: Channel state for channel "enterWithData": attaching
16:22:41.640 Ably: Connection state: connected
16:22:41.793 Ably: Channel state for channel "enterWithData": attached
Listener attached to channel enterWithData
presenceChannel: enterWithData
16:22:41.794 Ably: Connection state: connecting
16:22:41.821 Ably: Channel state for channel "presenceMessageAction": attached
16:22:41.838 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:41.838 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:41.839 Ably: Channel state for channel "presenceMessageAction": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” presenceMessageAction
16:22:41.856 Ably: Connection state: connecting
16:22:41.859 Ably: Connection state: connected
16:22:41.859 Ably: Channel state for channel "enterWithData": attaching
16:22:41.875 Ably: Channel state for channel "enterWithData": attached
in callback, err =  null
16:22:41.893 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:41.894 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:41.894 Ably: Channel state for channel "enterWithData": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:41.894 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:41.895 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:41.895 Ably: Channel state for channel "enterWithData": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterWithData
16:22:41.910 Ably: Connection state: connecting
16:22:41.911 Ably: Connection state: connected
Listener connected
16:22:41.912 Ably: Channel state for channel "enterDetachEnter": attaching
16:22:41.970 Ably: Connection state: connected
16:22:41.971 Ably: Channel state for channel "": attaching
16:22:42.14 Ably: Channel state for channel "enterDetachEnter": attached
Listener attached to channel enterDetachEnter
presenceChannel: enterDetachEnter
16:22:42.15 Ably: Connection state: connecting
16:22:42.69 Ably: Connection state: connected
16:22:42.70 Ably: Channel state for channel "enterDetachEnter": attaching
16:22:42.83 Ably: Channel state for channel "enterDetachEnter": attached
16:22:42.102 Ably: Channel state for channel "enterDetachEnter": detaching
16:22:42.115 Ably: Channel state for channel "enterDetachEnter": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:22:42.116 Ably: Channel state for channel "enterDetachEnter": attaching
16:22:42.128 Ably: Channel state for channel "enterDetachEnter": attached
16:22:42.195 Ably: Channel state for channel "": failed; reason: [ErrorInfo: Invalid channel id (); statusCode=400; code=40010]
16:22:42.195 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:42.195 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” presenceEnterInvalid
16:22:42.207 Ably: Connection state: connecting
16:22:42.260 Ably: Connection state: connected
Listener connected
16:22:42.261 Ably: Channel state for channel "enterAndLeave": attaching
16:22:42.437 Ably: Channel state for channel "enterAndLeave": attached
Listener attached to channel enterAndLeave
presenceChannel: enterAndLeave
16:22:42.438 Ably: Connection state: connecting
16:22:42.499 Ably: Connection state: connected
16:22:42.499 Ably: Channel state for channel "enterAndLeave": attaching
16:22:42.518 Ably: Channel state for channel "enterAndLeave": attached
in callback, err =  null
16:22:42.603 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:42.603 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:42.603 Ably: Channel state for channel "enterDetachEnter": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:42.603 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:42.604 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:42.604 Ably: Channel state for channel "enterDetachEnter": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterDetachEnter
16:22:42.617 Ably: Connection state: connecting
16:22:42.669 Ably: Connection state: connected
Listener connected
16:22:42.669 Ably: Channel state for channel "enterUpdate": attaching
16:22:42.772 Ably: Channel state for channel "enterUpdate": attached
Listener attached to channel enterUpdate
presenceChannel: enterUpdate
16:22:42.772 Ably: Connection state: connecting
16:22:42.828 Ably: Connection state: connected
16:22:42.828 Ably: Channel state for channel "enterUpdate": attaching
16:22:42.850 Ably: Channel state for channel "enterUpdate": attached
in callback, err =  null
16:22:43.35 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.36 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.36 Ably: Channel state for channel "enterAndLeave": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:43.36 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.36 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.36 Ably: Channel state for channel "enterAndLeave": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterAndLeave
16:22:43.82 Ably: Connection state: connecting
16:22:43.136 Ably: Connection state: connected
Listener connected
16:22:43.137 Ably: Channel state for channel "enterGet": attaching
16:22:43.240 Ably: Channel state for channel "enterGet": attached
Listener attached to channel enterGet
presenceChannel: enterGet
16:22:43.240 Ably: Connection state: connecting
16:22:43.300 Ably: Connection state: connected
16:22:43.300 Ably: Channel state for channel "enterGet": attaching
16:22:43.317 Ably: Channel state for channel "enterGet": attached
in callback, err =  null
16:22:43.336 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.336 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.336 Ably: Channel state for channel "enterGet": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:43.336 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.336 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.336 Ably: Channel state for channel "enterGet": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterGet
16:22:43.351 Ably: Connection state: connecting
in callback, err =  null
16:22:43.368 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.368 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.368 Ably: Channel state for channel "enterUpdate": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:43.368 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.368 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.369 Ably: Channel state for channel "enterUpdate": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterUpdate
16:22:43.382 Ably: Connection state: connecting
16:22:43.415 Ably: Connection state: connected
16:22:43.415 Ably: Channel state for channel "subscribeUnattached": attaching
16:22:43.416 Ably: Connection state: connecting
16:22:43.445 Ably: Connection state: connected
16:22:43.445 Ably: Channel state for channel "getUnattached": attaching
16:22:43.476 Ably: Connection state: connected
16:22:43.476 Ably: Channel state for channel "subscribeUnattached": attaching
16:22:43.595 Ably: Channel state for channel "subscribeUnattached": attached
16:22:43.596 Ably: Channel state for channel "subscribeUnattached": attached
16:22:43.611 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.612 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.612 Ably: Channel state for channel "subscribeUnattached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:43.612 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.612 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.612 Ably: Channel state for channel "subscribeUnattached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
16:22:43.628 Ably: Channel state for channel "getUnattached": attached
Transport disposed; calling test.done()
âœ” presenceSubscribeUnattached
16:22:43.628 Ably: Connection state: connecting
16:22:43.649 Ably: Connection state: connecting
16:22:43.686 Ably: Connection state: connected
Listener connected
16:22:43.686 Ably: Channel state for channel "enterLeaveGet": attaching
16:22:43.708 Ably: Connection state: connected
16:22:43.709 Ably: Channel state for channel "getUnattached": attaching
16:22:43.731 Ably: Channel state for channel "getUnattached": attached
16:22:43.737 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.737 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.737 Ably: Channel state for channel "getUnattached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:43.738 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:43.738 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:43.738 Ably: Channel state for channel "getUnattached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceGetUnattached
16:22:43.751 Ably: Connection state: connecting
16:22:43.814 Ably: Connection state: connected
16:22:43.814 Ably: Channel state for channel "history": attaching
16:22:43.872 Ably: Channel state for channel "enterLeaveGet": attached
Listener attached to channel enterLeaveGet
presenceChannel: enterLeaveGet
16:22:43.873 Ably: Connection state: connecting
16:22:43.913 Ably: Channel state for channel "history": attached
16:22:43.924 Ably: Connection state: connected
16:22:43.924 Ably: Channel state for channel "enterLeaveGet": attaching
16:22:43.942 Ably: Channel state for channel "enterLeaveGet": attached
16:22:44.431 Ably: Channel state for channel "history": detaching
16:22:44.444 Ably: Channel state for channel "history": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
in callback, err =  null
16:22:44.459 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:44.460 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:44.460 Ably: Channel state for channel "enterLeaveGet": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:44.460 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:44.460 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:44.460 Ably: Channel state for channel "enterLeaveGet": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterLeaveGet
16:22:44.474 Ably: Connection state: connecting
16:22:44.484 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:44.484 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” presenceHistory
16:22:44.497 Ably: Connection state: connecting
16:22:44.555 Ably: Connection state: connected
16:22:44.556 Ably: Channel state for channel "secondConnection": attaching
16:22:44.624 Ably: Connection state: connected
16:22:44.625 Ably: Channel state for channel "historyUntilAttach": attaching
16:22:44.741 Ably: Channel state for channel "secondConnection": attached
16:22:44.760 Ably: Connection state: connecting
16:22:44.807 Ably: Channel state for channel "historyUntilAttach": attached
16:22:44.822 Ably: Connection state: connected
16:22:44.822 Ably: Channel state for channel "secondConnection": attaching
16:22:44.834 Ably: Channel state for channel "secondConnection": attached
[ PresenceMessage {
    action: 'present',
    id: 'hRl4-IUSU8:0:0',
    timestamp: 1488903764826,
    clientId: 'testclient',
    connectionId: 'hRl4-IUSU8',
    data: 'Test client data (attach0)',
    encoding: undefined } ] [ PresenceMessage {
    action: 'present',
    id: 'hRl4-IUSU8:0:0',
    timestamp: 1488903764826,
    clientId: 'testclient',
    connectionId: 'hRl4-IUSU8',
    data: 'Test client data (attach0)',
    encoding: undefined } ]
16:22:44.841 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:44.841 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:44.841 Ably: Channel state for channel "secondConnection": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:44.842 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:44.842 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:44.842 Ably: Channel state for channel "secondConnection": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceSecondConnection
16:22:44.861 Ably: Connection state: connecting
16:22:44.861 Ably: Connection state: connecting
16:22:44.922 Ably: Connection state: connected
16:22:44.923 Ably: Channel state for channel "twoMembers": attaching
16:22:44.929 Ably: Connection state: connected
16:22:44.930 Ably: Channel state for channel "twoMembers": attaching
16:22:45.23 Ably: Channel state for channel "twoMembers": attached
16:22:45.27 Ably: Channel state for channel "twoMembers": attached
16:22:45.45 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:45.45 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:45.45 Ably: Channel state for channel "twoMembers": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:45.45 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:45.45 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:45.45 Ably: Channel state for channel "twoMembers": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceTwoMembers
16:22:45.60 Ably: Connection state: connecting
16:22:45.121 Ably: Connection state: connected
Listener connected
16:22:45.121 Ably: Channel state for channel "enterAfterClose": attaching
16:22:45.305 Ably: Channel state for channel "enterAfterClose": attached
Listener attached to channel enterAfterClose
presenceChannel: enterAfterClose
16:22:45.306 Ably: Connection state: connecting
16:22:45.328 Ably: Channel state for channel "historyUntilAttach": detaching
16:22:45.340 Ably: Channel state for channel "historyUntilAttach": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:22:45.340 Ably: Channel state for channel "historyUntilAttach": attaching
16:22:45.352 Ably: Channel state for channel "historyUntilAttach": attached
16:22:45.365 Ably: Connection state: connected
16:22:45.365 Ably: Channel state for channel "enterAfterClose": attaching
16:22:45.382 Ably: Channel state for channel "enterAfterClose": attached
16:22:45.400 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:45.401 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:45.401 Ably: Channel state for channel "enterAfterClose": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:45.402 Ably: Connection state: connecting
16:22:45.484 Ably: Connection state: connected
16:22:45.484 Ably: Channel state for channel "enterAfterClose": attaching
16:22:45.508 Ably: Channel state for channel "enterAfterClose": attached
in callback, err =  null
16:22:45.543 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:45.544 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:45.544 Ably: Channel state for channel "enterAfterClose": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:45.544 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:45.544 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:45.544 Ably: Channel state for channel "enterAfterClose": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEnterAfterClose
16:22:45.562 Ably: Connection state: connecting
16:22:45.650 Ably: Connection state: connected
16:22:45.650 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:45.650 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” presenceEnterClosed
16:22:45.651 Ably: Connection state: connecting
16:22:45.652 Ably: Channel state for channel "presenceClientIdIsImplicit": attaching
16:22:45.849 Ably: Connection state: connected
16:22:45.950 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:45.951 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:45.951 Ably: Channel state for channel "historyUntilAttach": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:45.953 Ably: Channel state for channel "presenceClientIdIsImplicit": attached
Transport disposed; calling test.done()
âœ” presenceHistoryUntilAttach
16:22:45.967 Ably: Connection state: connecting
16:22:46.38 Ably: Connection state: connected
Listener connected
16:22:46.38 Ably: Channel state for channel "enterOn": attaching
16:22:46.144 Ably: Channel state for channel "enterOn": attached
Listener attached to channel enterOn
presenceChannel: enterOn
16:22:46.145 Ably: Deprecation warning - 'presence.on' is deprecated and will be removed from a future version. Please use 'presence.subscribe' instead.
16:22:46.145 Ably: Connection state: connecting
16:22:46.201 Ably: Connection state: connected
16:22:46.201 Ably: Channel state for channel "enterOn": attaching
16:22:46.220 Ably: Channel state for channel "enterOn": attached
in callback, err =  null
16:22:46.238 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:46.238 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:46.239 Ably: Channel state for channel "enterOn": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:46.239 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:46.239 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:46.239 Ably: Channel state for channel "enterOn": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceOn
realtimeBin
16:22:46.254 Ably: Connection state: connecting
16:22:46.311 Ably: Channel state for channel "presence-bin-encoding": attaching
16:22:46.311 Ably: Connection state: connected
realtimeJson
16:22:46.491 Ably: Connection state: connecting
16:22:46.491 Ably: Channel state for channel "presence-bin-encoding": attached
16:22:46.494 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:46.494 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:46.495 Ably: Channel state for channel "presenceClientIdIsImplicit": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” presenceClientIdIsImplicit
16:22:46.508 Ably: Connection state: connecting
16:22:46.568 Ably: Channel state for channel "presence-json-encoding": attaching
16:22:46.568 Ably: Connection state: connected
16:22:46.574 Ably: Connection state: connected
Listener connected
16:22:46.574 Ably: Channel state for channel "enter_inherited_clientid": attaching
16:22:46.755 Ably: Channel state for channel "presence-json-encoding": attached
16:22:46.755 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:46.755 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:46.755 Ably: Channel state for channel "presence-bin-encoding": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:46.756 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:46.756 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:46.756 Ably: Channel state for channel "presence-json-encoding": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:46.759 Ably: Channel state for channel "enter_inherited_clientid": attached
Listener attached to channel enter_inherited_clientid
presenceChannel: enter_inherited_clientid
16:22:46.760 Ably: Connection state: connecting
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presenceEncoding
16:22:46.774 Ably: Connection state: connecting
16:22:46.832 Ably: Connection state: connected
Listener connected
16:22:46.833 Ably: Channel state for channel "enter_before_know_clientid": attaching
16:22:46.916 Ably: Connection state: connected
16:22:46.917 Ably: Channel state for channel "enter_inherited_clientid": attaching
16:22:46.939 Ably: Channel state for channel "enter_inherited_clientid": attached
in callback, err =  null
16:22:46.958 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:46.958 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:46.959 Ably: Channel state for channel "enter_inherited_clientid": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:46.959 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:46.960 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:46.960 Ably: Channel state for channel "enter_inherited_clientid": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presence_enter_inherited_clientid
16:22:46.973 Ably: Connection state: connecting
16:22:46.973 Ably: Connection state: connecting
16:22:47.16 Ably: Channel state for channel "enter_before_know_clientid": attached
Listener attached to channel enter_before_know_clientid
presenceChannel: enter_before_know_clientid
16:22:47.47 Ably: Connection state: connected
16:22:47.48 Ably: Channel state for channel "presence_refresh_on_detach": attaching
16:22:47.50 Ably: Connection state: connected
16:22:47.115 Ably: Channel state for channel "enter_before_know_clientid": attaching
16:22:47.115 Ably: Connection state: connecting
16:22:47.149 Ably: Channel state for channel "presence_refresh_on_detach": attached
16:22:47.177 Ably: Connection state: connected
16:22:47.191 Ably: Channel state for channel "enter_before_know_clientid": attached
in callback, err =  null
16:22:47.211 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:47.211 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:47.211 Ably: Channel state for channel "enter_before_know_clientid": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:47.212 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:47.212 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:47.212 Ably: Channel state for channel "enter_before_know_clientid": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presence_enter_before_know_clientid
16:22:47.226 Ably: Connection state: connecting
16:22:47.226 Ably: Connection state: connecting
16:22:47.283 Ably: Connection state: connected
16:22:47.283 Ably: Channel state for channel "presence_detach_during_sync": attaching
16:22:47.290 Ably: Connection state: connected
16:22:47.388 Ably: Channel state for channel "presence_detach_during_sync": attached
16:22:47.404 Ably: Channel state for channel "presence_detach_during_sync": attaching
16:22:47.424 Ably: Channel state for channel "presence_detach_during_sync": attached
16:22:47.425 Ably: Channel state for channel "presence_detach_during_sync": detaching
16:22:47.437 Ably: Channel state for channel "presence_detach_during_sync": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:22:47.438 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:47.438 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:47.438 Ably: Channel state for channel "presence_detach_during_sync": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:47.438 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:47.438 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presence_detach_during_sync
16:22:47.454 Ably: Connection state: connecting
16:22:47.521 Ably: Connection state: connected
16:22:47.521 Ably: Channel state for channel "presence_auto_reenter": attaching
16:22:47.666 Ably: Channel state for channel "presence_refresh_on_detach": attaching
16:22:47.686 Ably: Channel state for channel "presence_refresh_on_detach": attached
16:22:47.690 Ably: Channel state for channel "presence_refresh_on_detach": detaching
16:22:47.703 Ably: Channel state for channel "presence_refresh_on_detach": detached; reason: [ErrorInfo: Channel detached; statusCode=404; code=90001]
16:22:47.741 Ably: Channel state for channel "presence_auto_reenter": attached
16:22:47.762 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:22:47.762 Ably: Connection state: connecting
16:22:47.762 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:22:47.762 Ably: Channel state for channel "presence_auto_reenter": suspended; reason: [ErrorInfo: Connection to server unavailable; statusCode=400; code=80002]
16:22:47.763 Ably: Connection state: connecting
16:22:47.814 Ably: Connection state: connected
16:22:47.814 Ably: Channel state for channel "presence_auto_reenter": attaching
16:22:47.831 Ably: Channel state for channel "presence_auto_reenter": attached
16:22:47.852 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:47.853 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:47.853 Ably: Channel state for channel "presence_auto_reenter": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:47.853 Ably: RealtimePresence._ensureMyMembersPresent(): Presence auto-re-enter failed: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” presence_auto_reenter
16:22:47.962 Ably: Connection state: connecting
16:22:48.24 Ably: Connection state: connected
16:22:48.24 Ably: Channel state for channel "presence_failed_auto_reenter": attaching
16:22:48.126 Ably: Channel state for channel "presence_failed_auto_reenter": attached
16:22:48.127 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:22:48.127 Ably: Connection state: connecting
16:22:48.128 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:22:48.128 Ably: Channel state for channel "presence_failed_auto_reenter": suspended; reason: [ErrorInfo: Connection to server unavailable; statusCode=400; code=80002]
16:22:48.128 Ably: Connection state: connecting
16:22:48.195 Ably: Connection state: connected
16:22:48.195 Ably: Channel state for channel "presence_failed_auto_reenter": attaching
16:22:48.213 Ably: Channel state for channel "presence_failed_auto_reenter": attached
16:22:48.225 Ably: Protocol.onNack(): serial = 0; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:48.225 Ably: RealtimePresence._ensureMyMembersPresent(): Presence auto-re-enter failed: [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:48.225 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:48.226 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:48.226 Ably: Channel state for channel "presence_failed_auto_reenter": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:48.228 Ably: Channel state for channel "presence_refresh_on_detach": attaching
Transport disposed; calling test.done()
âœ” presence_failed_auto_reenter
16:22:48.238 Ably: Connection state: connecting
16:22:48.240 Ably: Channel state for channel "presence_refresh_on_detach": attached
16:22:48.244 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:48.244 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:48.244 Ably: Channel state for channel "presence_refresh_on_detach": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:48.244 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:48.245 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:48.245 Ably: Channel state for channel "presence_refresh_on_detach": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presence_refresh_on_detach
16:22:48.264 Ably: Connection state: connecting
16:22:48.264 Ably: Connection state: connecting
16:22:48.311 Ably: Connection state: connected
16:22:48.312 Ably: Channel state for channel "multiple_pending": attaching
16:22:48.329 Ably: Connection state: connected
16:22:48.425 Ably: Connection state: connected
16:22:48.425 Ably: Channel state for channel "leave_published_for_member_missing_from_sync": attaching
16:22:48.492 Ably: Channel state for channel "multiple_pending": attached
16:22:48.521 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:48.521 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:48.521 Ably: Channel state for channel "multiple_pending": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” multiple_pending
16:22:48.534 Ably: Connection state: connecting
16:22:48.589 Ably: Connection state: connected
16:22:48.589 Ably: Channel state for channel "leave_published_for_members_on_presenceless_attached": attaching
16:22:48.608 Ably: Channel state for channel "leave_published_for_member_missing_from_sync": attached
16:22:48.625 Ably: Channel state for channel "leave_published_for_member_missing_from_sync": attaching
16:22:48.642 Ably: Channel state for channel "leave_published_for_member_missing_from_sync": attached
16:22:48.662 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:48.663 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:48.663 Ably: Channel state for channel "leave_published_for_member_missing_from_sync": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:48.663 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:48.663 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:48.663 Ably: Channel state for channel "leave_published_for_member_missing_from_sync": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” leave_published_for_member_missing_from_sync
16:22:48.681 Ably: Connection state: connecting
16:22:48.681 Ably: Connection state: connecting
16:22:48.681 Ably: Connection state: connecting
16:22:48.692 Ably: Channel state for channel "leave_published_for_members_on_presenceless_attached": attached
16:22:48.693 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:48.694 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:48.694 Ably: Channel state for channel "leave_published_for_members_on_presenceless_attached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” leave_published_for_members_on_presenceless_attached
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]

[1mreauth.test.js[22m
âœ” setupreauth
16:22:48.809 Ably: Connection state: connecting
16:22:48.842 Ably: Connection state: connected
16:22:48.842 Ably: Channel state for channel "suspended_preserves_presence": attaching
16:22:48.848 Ably: Connection state: connected
16:22:48.852 Ably: Connection state: connected
16:22:48.888 Ably: Connection state: connected
16:22:48.889 Ably: Channel state for channel "rightchannel": attaching
16:22:48.904 Ably: Channel state for channel "rightchannel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = rightchannel; statusCode=401; code=40160]
16:22:48.943 Ably: Channel state for channel "suspended_preserves_presence": attached
16:22:48.960 Ably: Channel state for channel "suspended_preserves_presence": attaching
16:22:48.978 Ably: Channel state for channel "suspended_preserves_presence": attached
16:22:48.996 Ably: Channel state for channel "suspended_preserves_presence": attaching
16:22:49.14 Ably: Channel state for channel "rightchannel": attaching
16:22:49.15 Ably: Channel state for channel "suspended_preserves_presence": attached
16:22:49.36 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:22:49.36 Ably: Connection state: connecting
16:22:49.37 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:22:49.37 Ably: Channel state for channel "suspended_preserves_presence": suspended; reason: [ErrorInfo: Connection to server unavailable; statusCode=400; code=80002]
16:22:49.37 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:49.37 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:49.37 Ably: Channel state for channel "suspended_preserves_presence": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:49.38 Ably: Connection state: connecting
16:22:49.104 Ably: Connection state: connected
16:22:49.104 Ably: Channel state for channel "suspended_preserves_presence": attaching
16:22:49.117 Ably: Channel state for channel "rightchannel": attached
16:22:49.117 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:49.117 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:49.118 Ably: Channel state for channel "rightchannel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeNewChannel_with_web_socket_binary_transport
16:22:49.118 Ably: Channel state for channel "suspended_preserves_presence": attached
16:22:49.219 Ably: Connection state: connecting
16:22:49.294 Ably: Connection state: connected
16:22:49.295 Ably: Channel state for channel "rightchannel": attaching
16:22:49.308 Ably: Channel state for channel "rightchannel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = rightchannel; statusCode=401; code=40160]
16:22:49.421 Ably: Channel state for channel "rightchannel": attaching
16:22:49.434 Ably: Channel state for channel "rightchannel": attached
16:22:49.434 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:49.434 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:49.435 Ably: Channel state for channel "rightchannel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeNewChannel_with_web_socket_text_transport
16:22:49.531 Ably: Connection state: connecting
16:22:49.629 Ably: Connection state: connected
16:22:49.629 Ably: Channel state for channel "rightchannel": attaching
16:22:49.688 Ably: Channel state for channel "rightchannel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = rightchannel; statusCode=401; code=40160]
16:22:49.805 Ably: Channel state for channel "rightchannel": attaching
16:22:49.837 Ably: Channel state for channel "rightchannel": attached
16:22:49.838 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:49.838 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:49.838 Ably: Channel state for channel "rightchannel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeNewChannel_with_comet_binary_transport
16:22:49.938 Ably: Connection state: connecting
16:22:50.22 Ably: Connection state: connected
16:22:50.22 Ably: Channel state for channel "rightchannel": attaching
16:22:50.75 Ably: Channel state for channel "rightchannel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = rightchannel; statusCode=401; code=40160]
No transport established; closing connection and calling test.done()
16:22:50.120 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:50.121 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:50.121 Ably: Channel state for channel "suspended_preserves_presence": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:22:50.121 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:50.121 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:50.121 Ably: Channel state for channel "suspended_preserves_presence": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” suspended_preserves_presence
TypeError: Cannot read property 'setUp' of undefined
    at wrapGroup (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/core.js:285:14)
    at Object.exports.runSuite (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/core.js:93:13)
    at /mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/core.js:125:21
    at /mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/deps/async.js:513:13
    at iterate (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/deps/async.js:123:13)
    at /mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/deps/async.js:134:25
    at /mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/deps/async.js:515:17
    at Immediate.<anonymous> (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:146:17)
    at runCallback (timers.js:637:20)
    at tryOnImmediate (timers.js:610:5)
    at processImmediate [as _immediateCallback] (timers.js:582:5)
16:22:50.191 Ably: Channel state for channel "rightchannel": attaching
16:22:50.220 Ably: Channel state for channel "rightchannel": attached
16:22:50.221 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:50.221 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:50.221 Ably: Channel state for channel "rightchannel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeNewChannel_with_comet_text_transport
16:22:50.320 Ably: Connection state: connecting
16:22:50.400 Ably: Connection state: connected
16:22:50.403 Ably: Channel state for channel "rightchannel": attaching
16:22:50.466 Ably: Channel state for channel "rightchannel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = rightchannel; statusCode=401; code=40160]
16:22:50.578 Ably: Channel state for channel "rightchannel": attaching
16:22:50.593 Ably: Channel state for channel "rightchannel": attached
16:22:50.593 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:50.594 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:50.594 Ably: Channel state for channel "rightchannel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeNewChannel_with_binary_transport
16:22:50.692 Ably: Connection state: connecting
16:22:50.779 Ably: Connection state: connected
16:22:50.781 Ably: Channel state for channel "rightchannel": attaching
16:22:50.848 Ably: Channel state for channel "rightchannel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = rightchannel; statusCode=401; code=40160]
16:22:50.963 Ably: Channel state for channel "rightchannel": attaching
16:22:50.980 Ably: Channel state for channel "rightchannel": attached
16:22:50.980 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:50.980 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:50.980 Ably: Channel state for channel "rightchannel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeNewChannel_with_text_transport
16:22:51.78 Ably: Connection state: connecting
16:22:51.136 Ably: Connection state: connected
16:22:51.137 Ably: Channel state for channel "channel": attaching
16:22:51.239 Ably: Channel state for channel "channel": attached
16:22:51.359 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:51.360 Ably: Channel state for channel "channel": attaching
16:22:51.376 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:51.376 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:51.376 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” reauthCapabilityDowngradeFullChannel_with_web_socket_binary_transport
16:22:51.478 Ably: Connection state: connecting
16:22:51.544 Ably: Connection state: connected
16:22:51.544 Ably: Channel state for channel "channel": attaching
16:22:51.566 Ably: Channel state for channel "channel": attached
16:22:51.680 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:51.680 Ably: Channel state for channel "channel": attaching
16:22:51.694 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:51.695 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:51.695 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” reauthCapabilityDowngradeFullChannel_with_web_socket_text_transport
16:22:51.791 Ably: Connection state: connecting
16:22:51.907 Ably: Connection state: connected
16:22:51.907 Ably: Channel state for channel "channel": attaching
16:22:51.976 Ably: Channel state for channel "channel": attached
16:22:52.105 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:52.105 Ably: Channel state for channel "channel": attaching
16:22:52.123 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:52.123 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:52.123 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” reauthCapabilityDowngradeFullChannel_with_comet_binary_transport
16:22:52.235 Ably: Connection state: connecting
16:22:52.318 Ably: Connection state: connected
16:22:52.318 Ably: Channel state for channel "channel": attaching
16:22:52.387 Ably: Channel state for channel "channel": attached
16:22:52.520 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:52.521 Ably: Channel state for channel "channel": attaching
16:22:52.542 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:52.542 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:52.543 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” reauthCapabilityDowngradeFullChannel_with_comet_text_transport
16:22:52.643 Ably: Connection state: connecting
16:22:52.747 Ably: Connection state: connected
16:22:52.749 Ably: Channel state for channel "channel": attaching
16:22:52.816 Ably: Channel state for channel "channel": attached
16:22:52.932 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:52.933 Ably: Channel state for channel "channel": attaching
16:22:52.946 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:52.946 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:52.946 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” reauthCapabilityDowngradeFullChannel_with_binary_transport
16:22:53.45 Ably: Connection state: connecting
16:22:53.126 Ably: Connection state: connected
16:22:53.128 Ably: Channel state for channel "channel": attaching
16:22:53.195 Ably: Channel state for channel "channel": attached
16:22:53.307 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:53.307 Ably: Channel state for channel "channel": attaching
16:22:53.319 Ably: Channel state for channel "channel": failed; reason: [ErrorInfo: Channel denied access based on given capability; channelId = channel; statusCode=401; code=40160]
16:22:53.320 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:53.320 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” reauthCapabilityDowngradeFullChannel_with_text_transport
16:22:53.418 Ably: Connection state: connecting
16:22:53.486 Ably: Connection state: connected
16:22:53.487 Ably: Channel state for channel "channel": attaching
16:22:53.503 Ably: Channel state for channel "channel": attached
16:22:53.517 Ably: Protocol.onNack(): serial = 0; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:53.647 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:53.648 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:53.648 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeAddPublish_with_web_socket_binary_transport
16:22:53.744 Ably: Connection state: connecting
16:22:53.806 Ably: Connection state: connected
16:22:53.806 Ably: Channel state for channel "channel": attaching
16:22:53.824 Ably: Channel state for channel "channel": attached
16:22:53.836 Ably: Protocol.onNack(): serial = 0; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:53.962 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:53.962 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:53.962 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeAddPublish_with_web_socket_text_transport
16:22:54.59 Ably: Connection state: connecting
16:22:54.143 Ably: Connection state: connected
16:22:54.143 Ably: Channel state for channel "channel": attaching
16:22:54.202 Ably: Channel state for channel "channel": attached
16:22:54.219 Ably: Protocol.onNack(): serial = 0; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:54.358 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:54.358 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:54.358 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeAddPublish_with_comet_binary_transport
16:22:54.459 Ably: Connection state: connecting
16:22:54.537 Ably: Connection state: connected
16:22:54.538 Ably: Channel state for channel "channel": attaching
16:22:54.606 Ably: Channel state for channel "channel": attached
16:22:54.623 Ably: Protocol.onNack(): serial = 0; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:54.762 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:54.763 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:54.763 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeAddPublish_with_comet_text_transport
16:22:54.865 Ably: Connection state: connecting
16:22:54.957 Ably: Connection state: connected
16:22:54.959 Ably: Channel state for channel "channel": attaching
16:22:55.26 Ably: Channel state for channel "channel": attached
16:22:55.47 Ably: Protocol.onNack(): serial = 0; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:55.394 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:55.394 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:55.394 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeAddPublish_with_binary_transport
16:22:55.496 Ably: Connection state: connecting
16:22:55.585 Ably: Connection state: connected
16:22:55.587 Ably: Channel state for channel "channel": attaching
16:22:55.654 Ably: Channel state for channel "channel": attached
16:22:55.675 Ably: Protocol.onNack(): serial = 0; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:55.807 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:55.807 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:55.807 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityUpgradeAddPublish_with_text_transport
16:22:55.904 Ably: Connection state: connecting
16:22:55.968 Ably: Connection state: connected
16:22:55.968 Ably: Channel state for channel "channel": attaching
16:22:55.986 Ably: Channel state for channel "channel": attached
16:22:56.130 Ably: Protocol.onNack(): serial = 1; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:56.130 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:56.130 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:56.131 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityDowngradePublish_with_web_socket_binary_transport
16:22:56.227 Ably: Connection state: connecting
16:22:56.285 Ably: Connection state: connected
16:22:56.286 Ably: Channel state for channel "channel": attaching
16:22:56.297 Ably: Channel state for channel "channel": attached
16:22:56.433 Ably: Protocol.onNack(): serial = 1; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:56.433 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:56.433 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:56.434 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityDowngradePublish_with_web_socket_text_transport
16:22:56.532 Ably: Connection state: connecting
16:22:56.612 Ably: Connection state: connected
16:22:56.612 Ably: Channel state for channel "channel": attaching
16:22:56.670 Ably: Channel state for channel "channel": attached
16:22:56.821 Ably: Protocol.onNack(): serial = 1; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:56.821 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:56.821 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:56.821 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityDowngradePublish_with_comet_binary_transport
16:22:56.920 Ably: Connection state: connecting
16:22:57.10 Ably: Connection state: connected
16:22:57.10 Ably: Channel state for channel "channel": attaching
16:22:57.68 Ably: Channel state for channel "channel": attached
16:22:57.232 Ably: Protocol.onNack(): serial = 1; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:57.232 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:57.232 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:57.232 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityDowngradePublish_with_comet_text_transport
16:22:57.331 Ably: Connection state: connecting
16:22:57.411 Ably: Connection state: connected
16:22:57.413 Ably: Channel state for channel "channel": attaching
16:22:57.490 Ably: Channel state for channel "channel": attached
16:22:57.651 Ably: Protocol.onNack(): serial = 1; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:57.651 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:57.652 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:57.652 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityDowngradePublish_with_binary_transport
16:22:57.749 Ably: Connection state: connecting
16:22:57.835 Ably: Connection state: connected
16:22:57.837 Ably: Channel state for channel "channel": attaching
16:22:57.904 Ably: Channel state for channel "channel": attached
16:22:58.65 Ably: Protocol.onNack(): serial = 1; count = 1; err = [ErrorInfo: Unable to perform channel operation (permission denied); statusCode=401; code=40160]
16:22:58.65 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:22:58.66 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:22:58.66 Ably: Channel state for channel "channel": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” reauthCapabilityDowngradePublish_with_text_transport
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]
TRANSPORTS ["web_socket","comet"]

[1mresume.test.js[22m
âœ” setupResume
16:22:58.71 Ably: Connection state: connecting
16:22:58.71 Ably: Channel state for channel "resume_inactive0.15993005911584102": attaching
16:22:58.127 Ably: Connection state: connected
16:22:58.231 Ably: Channel state for channel "resume_inactive0.15993005911584102": attached
sending phase 1, message 0 at Tue Mar 07 2017 16:22:58 GMT+0000 (GMT)
received phase 1, message 0 at Tue Mar 07 2017 16:22:58 GMT+0000 (GMT)
sending phase 1, message 1 at Tue Mar 07 2017 16:22:59 GMT+0000 (GMT)
received phase 1, message 1 at Tue Mar 07 2017 16:22:59 GMT+0000 (GMT)
sending phase 1, message 2 at Tue Mar 07 2017 16:22:59 GMT+0000 (GMT)
received phase 1, message 2 at Tue Mar 07 2017 16:22:59 GMT+0000 (GMT)
sending phase 1, message 3 at Tue Mar 07 2017 16:23:00 GMT+0000 (GMT)
received phase 1, message 3 at Tue Mar 07 2017 16:23:00 GMT+0000 (GMT)
sending phase 1, message 4 at Tue Mar 07 2017 16:23:01 GMT+0000 (GMT)
received phase 1, message 4 at Tue Mar 07 2017 16:23:01 GMT+0000 (GMT)
phase 1 sent all messages, time:  Tue Mar 07 2017 16:23:01 GMT+0000 (GMT)
starting phase 2, time:  Tue Mar 07 2017 16:23:01 GMT+0000 (GMT)
16:23:1.542 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
starting phase 3, time:  Tue Mar 07 2017 16:23:06 GMT+0000 (GMT)
16:23:6.546 Ably: Connection state: connecting
starting phase 4, time:  Tue Mar 07 2017 16:23:06 GMT+0000 (GMT)
sending phase 4, message 0 at Tue Mar 07 2017 16:23:06 GMT+0000 (GMT)
16:23:6.624 Ably: Connection state: connected
received phase 4, message 0 at Tue Mar 07 2017 16:23:06 GMT+0000 (GMT)
sending phase 4, message 1 at Tue Mar 07 2017 16:23:07 GMT+0000 (GMT)
received phase 4, message 1 at Tue Mar 07 2017 16:23:07 GMT+0000 (GMT)
sending phase 4, message 2 at Tue Mar 07 2017 16:23:08 GMT+0000 (GMT)
received phase 4, message 2 at Tue Mar 07 2017 16:23:08 GMT+0000 (GMT)
sending phase 4, message 3 at Tue Mar 07 2017 16:23:09 GMT+0000 (GMT)
received phase 4, message 3 at Tue Mar 07 2017 16:23:09 GMT+0000 (GMT)
sending phase 4, message 4 at Tue Mar 07 2017 16:23:09 GMT+0000 (GMT)
received phase 4, message 4 at Tue Mar 07 2017 16:23:09 GMT+0000 (GMT)
phase 4 sent all messages, time:  Tue Mar 07 2017 16:23:09 GMT+0000 (GMT)
16:23:9.945 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:23:9.946 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:23:9.946 Ably: Channel state for channel "resume_inactive0.15993005911584102": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_inactive_with_web_socket_binary_transport
16:23:9.959 Ably: Connection state: connecting
16:23:9.959 Ably: Channel state for channel "resume_inactive0.03675494720487871": attaching
16:23:10.53 Ably: Connection state: connected
16:23:10.233 Ably: Channel state for channel "resume_inactive0.03675494720487871": attached
sending phase 1, message 0 at Tue Mar 07 2017 16:23:10 GMT+0000 (GMT)
received phase 1, message 0 at Tue Mar 07 2017 16:23:10 GMT+0000 (GMT)
sending phase 1, message 1 at Tue Mar 07 2017 16:23:11 GMT+0000 (GMT)
received phase 1, message 1 at Tue Mar 07 2017 16:23:11 GMT+0000 (GMT)
sending phase 1, message 2 at Tue Mar 07 2017 16:23:11 GMT+0000 (GMT)
received phase 1, message 2 at Tue Mar 07 2017 16:23:11 GMT+0000 (GMT)
sending phase 1, message 3 at Tue Mar 07 2017 16:23:12 GMT+0000 (GMT)
received phase 1, message 3 at Tue Mar 07 2017 16:23:12 GMT+0000 (GMT)
sending phase 1, message 4 at Tue Mar 07 2017 16:23:13 GMT+0000 (GMT)
received phase 1, message 4 at Tue Mar 07 2017 16:23:13 GMT+0000 (GMT)
phase 1 sent all messages, time:  Tue Mar 07 2017 16:23:13 GMT+0000 (GMT)
starting phase 2, time:  Tue Mar 07 2017 16:23:13 GMT+0000 (GMT)
16:23:13.548 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
starting phase 3, time:  Tue Mar 07 2017 16:23:18 GMT+0000 (GMT)
16:23:18.552 Ably: Connection state: connecting
starting phase 4, time:  Tue Mar 07 2017 16:23:18 GMT+0000 (GMT)
sending phase 4, message 0 at Tue Mar 07 2017 16:23:18 GMT+0000 (GMT)
16:23:18.611 Ably: Connection state: connected
received phase 4, message 0 at Tue Mar 07 2017 16:23:18 GMT+0000 (GMT)
sending phase 4, message 1 at Tue Mar 07 2017 16:23:19 GMT+0000 (GMT)
received phase 4, message 1 at Tue Mar 07 2017 16:23:19 GMT+0000 (GMT)
sending phase 4, message 2 at Tue Mar 07 2017 16:23:20 GMT+0000 (GMT)
received phase 4, message 2 at Tue Mar 07 2017 16:23:20 GMT+0000 (GMT)
sending phase 4, message 3 at Tue Mar 07 2017 16:23:21 GMT+0000 (GMT)
received phase 4, message 3 at Tue Mar 07 2017 16:23:21 GMT+0000 (GMT)
sending phase 4, message 4 at Tue Mar 07 2017 16:23:21 GMT+0000 (GMT)
received phase 4, message 4 at Tue Mar 07 2017 16:23:22 GMT+0000 (GMT)
phase 4 sent all messages, time:  Tue Mar 07 2017 16:23:22 GMT+0000 (GMT)
16:23:22.6 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:23:22.6 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:23:22.6 Ably: Channel state for channel "resume_inactive0.03675494720487871": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_inactive_with_web_socket_text_transport
16:23:22.20 Ably: Connection state: connecting
16:23:22.21 Ably: Channel state for channel "resume_inactive0.01921674693082398": attaching
16:23:22.134 Ably: Connection state: connected
16:23:22.374 Ably: Channel state for channel "resume_inactive0.01921674693082398": attached
sending phase 1, message 0 at Tue Mar 07 2017 16:23:22 GMT+0000 (GMT)
received phase 1, message 0 at Tue Mar 07 2017 16:23:22 GMT+0000 (GMT)
sending phase 1, message 1 at Tue Mar 07 2017 16:23:23 GMT+0000 (GMT)
received phase 1, message 1 at Tue Mar 07 2017 16:23:23 GMT+0000 (GMT)
sending phase 1, message 2 at Tue Mar 07 2017 16:23:24 GMT+0000 (GMT)
received phase 1, message 2 at Tue Mar 07 2017 16:23:24 GMT+0000 (GMT)
sending phase 1, message 3 at Tue Mar 07 2017 16:23:24 GMT+0000 (GMT)
received phase 1, message 3 at Tue Mar 07 2017 16:23:24 GMT+0000 (GMT)
sending phase 1, message 4 at Tue Mar 07 2017 16:23:25 GMT+0000 (GMT)
received phase 1, message 4 at Tue Mar 07 2017 16:23:25 GMT+0000 (GMT)
phase 1 sent all messages, time:  Tue Mar 07 2017 16:23:25 GMT+0000 (GMT)
starting phase 2, time:  Tue Mar 07 2017 16:23:25 GMT+0000 (GMT)
16:23:25.744 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
starting phase 3, time:  Tue Mar 07 2017 16:23:30 GMT+0000 (GMT)
16:23:30.746 Ably: Connection state: connecting
starting phase 4, time:  Tue Mar 07 2017 16:23:30 GMT+0000 (GMT)
sending phase 4, message 0 at Tue Mar 07 2017 16:23:30 GMT+0000 (GMT)
16:23:30.842 Ably: Connection state: connected
received phase 4, message 0 at Tue Mar 07 2017 16:23:30 GMT+0000 (GMT)
sending phase 4, message 1 at Tue Mar 07 2017 16:23:31 GMT+0000 (GMT)
received phase 4, message 1 at Tue Mar 07 2017 16:23:31 GMT+0000 (GMT)
sending phase 4, message 2 at Tue Mar 07 2017 16:23:32 GMT+0000 (GMT)
received phase 4, message 2 at Tue Mar 07 2017 16:23:32 GMT+0000 (GMT)
sending phase 4, message 3 at Tue Mar 07 2017 16:23:33 GMT+0000 (GMT)
received phase 4, message 3 at Tue Mar 07 2017 16:23:33 GMT+0000 (GMT)
sending phase 4, message 4 at Tue Mar 07 2017 16:23:34 GMT+0000 (GMT)
received phase 4, message 4 at Tue Mar 07 2017 16:23:34 GMT+0000 (GMT)
phase 4 sent all messages, time:  Tue Mar 07 2017 16:23:34 GMT+0000 (GMT)
16:23:34.179 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:23:34.181 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:23:34.181 Ably: Channel state for channel "resume_inactive0.01921674693082398": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_inactive_with_comet_binary_transport
16:23:34.183 Ably: Connection state: connecting
16:23:34.183 Ably: Channel state for channel "resume_inactive0.6455314547582913": attaching
16:23:34.276 Ably: Connection state: connected
16:23:34.514 Ably: Channel state for channel "resume_inactive0.6455314547582913": attached
sending phase 1, message 0 at Tue Mar 07 2017 16:23:34 GMT+0000 (GMT)
received phase 1, message 0 at Tue Mar 07 2017 16:23:34 GMT+0000 (GMT)
sending phase 1, message 1 at Tue Mar 07 2017 16:23:35 GMT+0000 (GMT)
received phase 1, message 1 at Tue Mar 07 2017 16:23:35 GMT+0000 (GMT)
sending phase 1, message 2 at Tue Mar 07 2017 16:23:36 GMT+0000 (GMT)
received phase 1, message 2 at Tue Mar 07 2017 16:23:36 GMT+0000 (GMT)
sending phase 1, message 3 at Tue Mar 07 2017 16:23:37 GMT+0000 (GMT)
received phase 1, message 3 at Tue Mar 07 2017 16:23:37 GMT+0000 (GMT)
sending phase 1, message 4 at Tue Mar 07 2017 16:23:37 GMT+0000 (GMT)
received phase 1, message 4 at Tue Mar 07 2017 16:23:37 GMT+0000 (GMT)
phase 1 sent all messages, time:  Tue Mar 07 2017 16:23:37 GMT+0000 (GMT)
starting phase 2, time:  Tue Mar 07 2017 16:23:37 GMT+0000 (GMT)
16:23:37.865 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
starting phase 3, time:  Tue Mar 07 2017 16:23:42 GMT+0000 (GMT)
16:23:42.866 Ably: Connection state: connecting
starting phase 4, time:  Tue Mar 07 2017 16:23:42 GMT+0000 (GMT)
sending phase 4, message 0 at Tue Mar 07 2017 16:23:42 GMT+0000 (GMT)
16:23:42.955 Ably: Connection state: connected
received phase 4, message 0 at Tue Mar 07 2017 16:23:42 GMT+0000 (GMT)
sending phase 4, message 1 at Tue Mar 07 2017 16:23:43 GMT+0000 (GMT)
received phase 4, message 1 at Tue Mar 07 2017 16:23:43 GMT+0000 (GMT)
sending phase 4, message 2 at Tue Mar 07 2017 16:23:44 GMT+0000 (GMT)
received phase 4, message 2 at Tue Mar 07 2017 16:23:44 GMT+0000 (GMT)
sending phase 4, message 3 at Tue Mar 07 2017 16:23:45 GMT+0000 (GMT)
received phase 4, message 3 at Tue Mar 07 2017 16:23:45 GMT+0000 (GMT)
sending phase 4, message 4 at Tue Mar 07 2017 16:23:46 GMT+0000 (GMT)
received phase 4, message 4 at Tue Mar 07 2017 16:23:46 GMT+0000 (GMT)
phase 4 sent all messages, time:  Tue Mar 07 2017 16:23:46 GMT+0000 (GMT)
16:23:46.290 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:23:46.291 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:23:46.291 Ably: Channel state for channel "resume_inactive0.6455314547582913": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_inactive_with_comet_text_transport
16:23:46.293 Ably: Connection state: connecting
16:23:46.293 Ably: Channel state for channel "resume1": attaching
16:23:46.391 Ably: Connection state: connected
16:23:46.494 Ably: Channel state for channel "resume1": attached
sending phase 1, message 0 at Tue Mar 07 2017 16:23:46 GMT+0000 (GMT)
received phase 1, message 0 at Tue Mar 07 2017 16:23:46 GMT+0000 (GMT)
sending phase 1, message 1 at Tue Mar 07 2017 16:23:47 GMT+0000 (GMT)
received phase 1, message 1 at Tue Mar 07 2017 16:23:47 GMT+0000 (GMT)
sending phase 1, message 2 at Tue Mar 07 2017 16:23:48 GMT+0000 (GMT)
received phase 1, message 2 at Tue Mar 07 2017 16:23:48 GMT+0000 (GMT)
sending phase 1, message 3 at Tue Mar 07 2017 16:23:48 GMT+0000 (GMT)
received phase 1, message 3 at Tue Mar 07 2017 16:23:48 GMT+0000 (GMT)
sending phase 1, message 4 at Tue Mar 07 2017 16:23:49 GMT+0000 (GMT)
received phase 1, message 4 at Tue Mar 07 2017 16:23:49 GMT+0000 (GMT)
phase 1 sent all messages, time:  Tue Mar 07 2017 16:23:49 GMT+0000 (GMT)
16:23:49.813 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
sending (phase 2): 0
sending (phase 2): 1
sending (phase 2): 2
sending (phase 2): 3
sending (phase 2): 4
16:23:55.622 Ably: Connection state: connecting
16:23:55.676 Ably: Connection state: connected
received phase 2, message 0 at Tue Mar 07 2017 16:23:55 GMT+0000 (GMT)
received phase 2, message 1 at Tue Mar 07 2017 16:23:55 GMT+0000 (GMT)
received phase 2, message 2 at Tue Mar 07 2017 16:23:55 GMT+0000 (GMT)
received phase 2, message 3 at Tue Mar 07 2017 16:23:55 GMT+0000 (GMT)
received phase 2, message 4 at Tue Mar 07 2017 16:23:55 GMT+0000 (GMT)
16:23:57.677 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:23:57.678 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:23:57.678 Ably: Channel state for channel "resume1": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_active_with_web_socket_binary_transport
16:23:57.690 Ably: Connection state: connecting
16:23:57.690 Ably: Channel state for channel "resume1": attaching
16:23:57.768 Ably: Connection state: connected
16:23:57.780 Ably: Channel state for channel "resume1": attached
sending phase 1, message 0 at Tue Mar 07 2017 16:23:57 GMT+0000 (GMT)
received phase 1, message 0 at Tue Mar 07 2017 16:23:57 GMT+0000 (GMT)
sending phase 1, message 1 at Tue Mar 07 2017 16:23:58 GMT+0000 (GMT)
received phase 1, message 1 at Tue Mar 07 2017 16:23:58 GMT+0000 (GMT)
sending phase 1, message 2 at Tue Mar 07 2017 16:23:59 GMT+0000 (GMT)
received phase 1, message 2 at Tue Mar 07 2017 16:23:59 GMT+0000 (GMT)
sending phase 1, message 3 at Tue Mar 07 2017 16:24:00 GMT+0000 (GMT)
received phase 1, message 3 at Tue Mar 07 2017 16:24:00 GMT+0000 (GMT)
sending phase 1, message 4 at Tue Mar 07 2017 16:24:01 GMT+0000 (GMT)
received phase 1, message 4 at Tue Mar 07 2017 16:24:01 GMT+0000 (GMT)
phase 1 sent all messages, time:  Tue Mar 07 2017 16:24:01 GMT+0000 (GMT)
16:24:1.86 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
sending (phase 2): 0
sending (phase 2): 1
sending (phase 2): 2
sending (phase 2): 3
sending (phase 2): 4
16:24:6.892 Ably: Connection state: connecting
16:24:6.952 Ably: Connection state: connected
received phase 2, message 0 at Tue Mar 07 2017 16:24:06 GMT+0000 (GMT)
received phase 2, message 1 at Tue Mar 07 2017 16:24:06 GMT+0000 (GMT)
received phase 2, message 2 at Tue Mar 07 2017 16:24:06 GMT+0000 (GMT)
received phase 2, message 3 at Tue Mar 07 2017 16:24:06 GMT+0000 (GMT)
received phase 2, message 4 at Tue Mar 07 2017 16:24:06 GMT+0000 (GMT)
16:24:8.956 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:8.956 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:8.956 Ably: Channel state for channel "resume1": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_active_with_web_socket_text_transport
16:24:8.970 Ably: Connection state: connecting
16:24:8.975 Ably: Channel state for channel "resume1": attaching
16:24:9.62 Ably: Connection state: connected
16:24:9.141 Ably: Channel state for channel "resume1": attached
sending phase 1, message 0 at Tue Mar 07 2017 16:24:09 GMT+0000 (GMT)
received phase 1, message 0 at Tue Mar 07 2017 16:24:09 GMT+0000 (GMT)
sending phase 1, message 1 at Tue Mar 07 2017 16:24:09 GMT+0000 (GMT)
received phase 1, message 1 at Tue Mar 07 2017 16:24:09 GMT+0000 (GMT)
sending phase 1, message 2 at Tue Mar 07 2017 16:24:10 GMT+0000 (GMT)
received phase 1, message 2 at Tue Mar 07 2017 16:24:10 GMT+0000 (GMT)
sending phase 1, message 3 at Tue Mar 07 2017 16:24:11 GMT+0000 (GMT)
received phase 1, message 3 at Tue Mar 07 2017 16:24:11 GMT+0000 (GMT)
sending phase 1, message 4 at Tue Mar 07 2017 16:24:12 GMT+0000 (GMT)
received phase 1, message 4 at Tue Mar 07 2017 16:24:12 GMT+0000 (GMT)
phase 1 sent all messages, time:  Tue Mar 07 2017 16:24:12 GMT+0000 (GMT)
16:24:12.471 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
sending (phase 2): 0
sending (phase 2): 1
sending (phase 2): 2
sending (phase 2): 3
sending (phase 2): 4
16:24:18.280 Ably: Connection state: connecting
16:24:18.408 Ably: Connection state: connected
received phase 2, message 0 at Tue Mar 07 2017 16:24:18 GMT+0000 (GMT)
received phase 2, message 1 at Tue Mar 07 2017 16:24:18 GMT+0000 (GMT)
received phase 2, message 2 at Tue Mar 07 2017 16:24:18 GMT+0000 (GMT)
received phase 2, message 3 at Tue Mar 07 2017 16:24:18 GMT+0000 (GMT)
received phase 2, message 4 at Tue Mar 07 2017 16:24:18 GMT+0000 (GMT)
16:24:20.408 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:20.409 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:20.409 Ably: Channel state for channel "resume1": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_active_with_comet_binary_transport
16:24:20.410 Ably: Connection state: connecting
16:24:20.410 Ably: Channel state for channel "resume1": attaching
16:24:20.493 Ably: Connection state: connected
16:24:20.562 Ably: Channel state for channel "resume1": attached
sending phase 1, message 0 at Tue Mar 07 2017 16:24:20 GMT+0000 (GMT)
received phase 1, message 0 at Tue Mar 07 2017 16:24:20 GMT+0000 (GMT)
sending phase 1, message 1 at Tue Mar 07 2017 16:24:21 GMT+0000 (GMT)
received phase 1, message 1 at Tue Mar 07 2017 16:24:21 GMT+0000 (GMT)
sending phase 1, message 2 at Tue Mar 07 2017 16:24:22 GMT+0000 (GMT)
received phase 1, message 2 at Tue Mar 07 2017 16:24:22 GMT+0000 (GMT)
sending phase 1, message 3 at Tue Mar 07 2017 16:24:23 GMT+0000 (GMT)
received phase 1, message 3 at Tue Mar 07 2017 16:24:23 GMT+0000 (GMT)
sending phase 1, message 4 at Tue Mar 07 2017 16:24:23 GMT+0000 (GMT)
received phase 1, message 4 at Tue Mar 07 2017 16:24:23 GMT+0000 (GMT)
phase 1 sent all messages, time:  Tue Mar 07 2017 16:24:23 GMT+0000 (GMT)
16:24:23.903 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
sending (phase 2): 0
sending (phase 2): 1
sending (phase 2): 2
sending (phase 2): 3
sending (phase 2): 4
16:24:29.710 Ably: Connection state: connecting
16:24:29.806 Ably: Connection state: connected
received phase 2, message 0 at Tue Mar 07 2017 16:24:29 GMT+0000 (GMT)
received phase 2, message 1 at Tue Mar 07 2017 16:24:29 GMT+0000 (GMT)
received phase 2, message 2 at Tue Mar 07 2017 16:24:29 GMT+0000 (GMT)
received phase 2, message 3 at Tue Mar 07 2017 16:24:29 GMT+0000 (GMT)
received phase 2, message 4 at Tue Mar 07 2017 16:24:29 GMT+0000 (GMT)
16:24:31.807 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:31.808 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:31.808 Ably: Channel state for channel "resume1": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_active_with_comet_text_transport
16:24:31.809 Ably: Connection state: connecting
16:24:31.891 Ably: Connection state: connected
16:24:31.891 Ably: Channel state for channel "resume_lost_continuity_attached": attaching
16:24:32.196 Ably: Channel state for channel "resume_lost_continuity_attached": attached
16:24:32.197 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:32.198 Ably: Connection state: connecting
16:24:32.259 Ably: ConnectionManager.activateTransport(): error = [ErrorInfo: Unable to recover connection: not found (ablyjs_test_fake); statusCode=400; code=80008]
16:24:32.259 Ably: Connection state: connected; reason: Unable to recover connection: not found (ablyjs_test_fake), code: 80008
16:24:32.259 Ably: Channel state for channel "resume_lost_continuity_attached": attaching
16:24:32.260 Ably: Channel state for channel "resume_lost_continuity_suspended": attaching
16:24:32.260 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:32.260 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:32.260 Ably: Channel state for channel "resume_lost_continuity_attached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:24:32.260 Ably: Channel state for channel "resume_lost_continuity_suspended": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_lost_continuity_with_web_socket_binary_transport
16:24:32.274 Ably: Connection state: connecting
16:24:32.329 Ably: Connection state: connected
16:24:32.329 Ably: Channel state for channel "resume_lost_continuity_attached": attaching
16:24:32.344 Ably: Channel state for channel "resume_lost_continuity_attached": attached
16:24:32.344 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:32.344 Ably: Connection state: connecting
16:24:32.408 Ably: ConnectionManager.activateTransport(): error = [ErrorInfo: Unable to recover connection: not found (ablyjs_test_fake); statusCode=400; code=80008]
16:24:32.408 Ably: Connection state: connected; reason: Unable to recover connection: not found (ablyjs_test_fake), code: 80008
16:24:32.408 Ably: Channel state for channel "resume_lost_continuity_attached": attaching
16:24:32.409 Ably: Channel state for channel "resume_lost_continuity_suspended": attaching
16:24:32.409 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:32.409 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:32.409 Ably: Channel state for channel "resume_lost_continuity_attached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:24:32.409 Ably: Channel state for channel "resume_lost_continuity_suspended": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_lost_continuity_with_web_socket_text_transport
16:24:32.424 Ably: Connection state: connecting
16:24:32.514 Ably: Connection state: connected
16:24:32.514 Ably: Channel state for channel "resume_lost_continuity_attached": attaching
16:24:32.583 Ably: Channel state for channel "resume_lost_continuity_attached": attached
16:24:32.583 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:32.584 Ably: Connection state: connecting
16:24:32.668 Ably: ConnectionManager.activateTransport(): error = [ErrorInfo: Unable to recover connection: not found (ablyjs_test_fake); statusCode=400; code=80008]
16:24:32.668 Ably: Connection state: connected; reason: Unable to recover connection: not found (ablyjs_test_fake), code: 80008
16:24:32.668 Ably: Channel state for channel "resume_lost_continuity_attached": attaching
16:24:32.669 Ably: Channel state for channel "resume_lost_continuity_suspended": attaching
16:24:32.670 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:32.671 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:32.671 Ably: Channel state for channel "resume_lost_continuity_attached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:24:32.671 Ably: Channel state for channel "resume_lost_continuity_suspended": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_lost_continuity_with_comet_binary_transport
16:24:32.672 Ably: Connection state: connecting
16:24:32.785 Ably: CometTransport.sendItems(): on complete: err = {"statusCode":404,"code":80016,"message":"Invalid transport id: 98ae025pbyjQA4hcb","serverId":"frontend.4381.2.eu-west-2-A.i-081baa3e75ac415b1"}
16:24:32.794 Ably: Connection state: connected
16:24:32.794 Ably: Channel state for channel "resume_lost_continuity_attached": attaching
16:24:32.864 Ably: Channel state for channel "resume_lost_continuity_attached": attached
16:24:32.864 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:32.864 Ably: Connection state: connecting
16:24:32.947 Ably: ConnectionManager.activateTransport(): error = [ErrorInfo: Unable to recover connection: not found (ablyjs_test_fake); statusCode=400; code=80008]
16:24:32.947 Ably: Connection state: connected; reason: Unable to recover connection: not found (ablyjs_test_fake), code: 80008
16:24:32.948 Ably: Channel state for channel "resume_lost_continuity_attached": attaching
16:24:32.949 Ably: Channel state for channel "resume_lost_continuity_suspended": attaching
16:24:32.949 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:32.951 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:32.952 Ably: Channel state for channel "resume_lost_continuity_attached": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:24:32.952 Ably: Channel state for channel "resume_lost_continuity_suspended": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” resume_lost_continuity_with_comet_text_transport
16:24:32.954 Ably: Connection state: connecting
16:24:33.21 Ably: CometTransport.sendItems(): on complete: err = {"statusCode":404,"code":80016,"message":"Invalid transport id: 1dae02FKwUigA4hcU","serverId":"frontend.22d0.1.eu-west-2-A.i-081baa3e75ac415b1"}
16:24:33.22 Ably: CometTransport.sendItems(): on complete: err = {"code":"ECONNRESET"}
16:24:33.107 Ably: Connection state: connected
16:24:33.202 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:33.203 Ably: Connection state: connecting
16:24:33.261 Ably: Connection state: disconnected; reason: Token expired, code: 40142
16:24:34.203 Ably: Connection state: connecting
16:24:34.373 Ably: Connection state: connected
16:24:34.381 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:34.382 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” resume_token_error_with_web_socket_binary_transport
16:24:34.396 Ably: Connection state: connecting
16:24:34.548 Ably: Connection state: connected
16:24:34.644 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:34.644 Ably: Connection state: connecting
16:24:34.729 Ably: Connection state: disconnected; reason: Token expired, code: 40142
16:24:35.644 Ably: Connection state: connecting
16:24:35.820 Ably: Connection state: connected
16:24:35.821 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:35.821 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” resume_token_error_with_web_socket_text_transport
16:24:35.835 Ably: Connection state: connecting
16:24:36.27 Ably: Connection state: connected
16:24:36.123 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:36.123 Ably: Connection state: connecting
16:24:36.381 Ably: Connection state: connected
16:24:36.382 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:36.383 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” resume_token_error_with_comet_binary_transport
16:24:36.390 Ably: Connection state: connecting
16:24:36.575 Ably: Connection state: connected
16:24:36.672 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:36.673 Ably: Connection state: connecting
16:24:36.929 Ably: Connection state: connected
16:24:36.929 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:36.930 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” resume_token_error_with_comet_text_transport
16:24:36.931 Ably: Connection state: connecting
16:24:37.9 Ably: Connection state: connected
16:24:37.10 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:37.10 Ably: Connection state: connecting
16:24:37.79 Ably: Connection state: failed; reason: Provided key secret value does not match, code: 40101
No transport established; closing connection and calling test.done()
16:24:37.79 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:37.79 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” resume_fatal_error_with_web_socket_binary_transport
16:24:37.80 Ably: Connection state: connecting
16:24:37.138 Ably: Connection state: connected
16:24:37.138 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:37.139 Ably: Connection state: connecting
16:24:37.224 Ably: Connection state: failed; reason: Provided key secret value does not match, code: 40101
No transport established; closing connection and calling test.done()
16:24:37.225 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:37.225 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” resume_fatal_error_with_web_socket_text_transport
16:24:37.225 Ably: Connection state: connecting
16:24:37.238 Ably: WebSocketTransport.onWsClose(): Unclean disconnection of WebSocket ; code = 1008
16:24:37.307 Ably: Connection state: connected
16:24:37.308 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:37.309 Ably: Connection state: connecting
16:24:37.380 Ably: Connection state: failed; reason: Provided key secret value does not match, code: 40101
No transport established; closing connection and calling test.done()
16:24:37.381 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:37.381 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” resume_fatal_error_with_comet_binary_transport
16:24:37.381 Ably: Connection state: connecting
16:24:37.461 Ably: Connection state: connected
16:24:37.462 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:37.462 Ably: Connection state: connecting
16:24:37.529 Ably: Connection state: failed; reason: Provided key secret value does not match, code: 40101
No transport established; closing connection and calling test.done()
16:24:37.530 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:37.530 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” resume_fatal_error_with_comet_text_transport
16:24:37.531 Ably: Connection state: connecting
16:24:37.605 Ably: Connection state: connected
16:24:37.605 Ably: Channel state for channel "channel_resumed_flag": attaching
16:24:37.708 Ably: Channel state for channel "channel_resumed_flag": attached
16:24:37.709 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:37.709 Ably: Connection state: connecting
16:24:37.709 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:24:37.709 Ably: Channel state for channel "channel_resumed_flag": suspended; reason: [ErrorInfo: Connection to server unavailable; statusCode=400; code=80002]
16:24:37.710 Ably: Connection state: connecting
16:24:37.803 Ably: Connection state: connected
16:24:37.804 Ably: Channel state for channel "channel_resumed_flag": attaching
16:24:37.818 Ably: Channel state for channel "channel_resumed_flag": attached
No transport established; closing connection and calling test.done()
16:24:37.819 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:37.819 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:37.819 Ably: Channel state for channel "channel_resumed_flag": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
âœ” channel_resumed_flag
16:24:37.819 Ably: Connection state: connecting
16:24:37.890 Ably: Connection state: connected
16:24:37.890 Ably: Connection state: disconnected; reason: Connection to server temporarily unavailable, code: 80003
16:24:37.891 Ably: Connection state: connecting
16:24:37.891 Ably: Connection state: suspended; reason: Connection to server unavailable, code: 80002
16:24:37.891 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:24:37.891 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:37.891 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” no_resume_once_suspended

[1msync.test.js[22m
âœ” setupSync
16:24:37.894 Ably: Channel state for channel "syncexistingset": attached
âœ” sync_existing_set
16:24:37.896 Ably: Channel state for channel "sync_member_arrives_in_middle": attached
âœ” sync_member_arrives_in_middle
16:24:37.897 Ably: Channel state for channel "sync_member_arrives_normally_after_came_in_sync": attached
âœ” sync_member_arrives_normally_after_came_in_sync
16:24:37.897 Ably: Channel state for channel "sync_member_arrives_normally_before_comes_in_sync": attached
âœ” sync_member_arrives_normally_before_comes_in_sync
16:24:37.898 Ably: Channel state for channel "sync_ordering": attached
âœ” presence_ordering
16:24:37.899 Ably: Connection state: connecting
16:24:37.900 Ably: Connection state: connecting
16:24:37.969 Ably: Connection state: connected
16:24:37.969 Ably: Channel state for channel "presence_sync_interruptus": attaching
16:24:37.983 Ably: Connection state: connected
16:24:38.148 Ably: Channel state for channel "presence_sync_interruptus": attached
16:24:38.669 Ably: Channel state for channel "presence_sync_interruptus": attaching
16:24:38.693 Ably: Channel state for channel "presence_sync_interruptus": attached
16:24:38.732 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:38.732 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:38.732 Ably: Channel state for channel "presence_sync_interruptus": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
16:24:38.732 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:38.733 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:24:38.733 Ably: Channel state for channel "presence_sync_interruptus": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
Transport disposed; calling test.done()
âœ” presence_sync_interruptus
TRANSPORTS ["web_socket","comet"]

[1mtmp.test.js[22m
âœ” setupauth
REALTIMEOPTS {"transports":["web_socket"],"useBinaryProtocol":true}
16:24:38.865 Ably: Connection state: connecting
16:24:38.961 Ably: Connection state: connected
16:24:43.858 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:24:43.858 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:24:43.858 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:24:43.858 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:24:43.859 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:43.859 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_web_socket_binary_transport
REALTIMEOPTS {"transports":["web_socket"],"useBinaryProtocol":false}
16:24:44.178 Ably: Connection state: connecting
16:24:44.248 Ably: Connection state: connected
16:24:49.175 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:24:49.176 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:24:49.176 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:24:49.176 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:24:49.176 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:49.176 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_web_socket_text_transport
REALTIMEOPTS {"transports":["comet"],"useBinaryProtocol":true}
16:24:49.275 Ably: Connection state: connecting
16:24:49.381 Ably: Connection state: connected
16:24:54.275 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:24:54.275 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:24:54.275 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:24:54.275 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:24:54.276 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:54.276 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_comet_binary_transport
REALTIMEOPTS {"transports":["comet"],"useBinaryProtocol":false}
16:24:54.371 Ably: Connection state: connecting
16:24:54.486 Ably: Connection state: connected
16:24:59.370 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:24:59.371 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:24:59.371 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:24:59.371 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:24:59.371 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:24:59.371 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_comet_text_transport
REALTIMEOPTS {"transports":["web_socket","comet"],"useBinaryProtocol":true}
16:24:59.467 Ably: Connection state: connecting
16:24:59.566 Ably: Connection state: connected
16:25:4.465 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:25:4.466 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:25:4.466 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:25:4.466 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:25:4.466 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:4.467 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_binary_transport
REALTIMEOPTS {"transports":["web_socket","comet"],"useBinaryProtocol":false}
16:25:4.563 Ably: Connection state: connecting
16:25:4.661 Ably: Connection state: connected
16:25:9.561 Ably: Connection state: disconnected; reason: Key/token status changed (expire), code: 40142
16:25:9.562 Ably: Connection state: connecting
No transport established; closing connection and calling test.done()
16:25:9.562 Ably: Auth.requestToken(): Need a new token, but authOptions does not include any way to request one
16:25:9.562 Ably: Connection state: failed; reason: Need a new token, but authOptions does not include any way to request one, code: 40101
16:25:9.562 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:9.562 Ably: Connection state: closed; reason: Connection closed, code: 80017
âœ” auth_token_expires_with_text_transport

[1mupgrade.test.js[22m
âœ” setupUpgrade
âœ” setupUpgradeRest
16:25:9.569 Ably: Connection state: connecting
16:25:9.629 Ably: Connection state: connected
16:25:9.629 Ably: Channel state for channel "publishpreupgrade": attaching
16:25:9.733 Ably: Channel state for channel "publishpreupgrade": attached
16:25:9.760 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:9.761 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:25:9.761 Ably: Channel state for channel "publishpreupgrade": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishpreupgrade
16:25:9.774 Ably: Connection state: connecting
16:25:9.774 Ably: Channel state for channel "publishpostupgrade0": attaching
16:25:9.861 Ably: Connection state: connected
16:25:9.965 Ably: Channel state for channel "publishpostupgrade0": attached
16:25:10.3 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:10.3 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:25:10.3 Ably: Channel state for channel "publishpostupgrade0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishpostupgrade0
16:25:10.40 Ably: Connection state: connecting
16:25:10.40 Ably: Channel state for channel "publishpostupgrade1": attaching
16:25:10.117 Ably: Connection state: connected
16:25:10.299 Ably: Channel state for channel "publishpostupgrade1": attached
16:25:10.326 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:10.327 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:25:10.327 Ably: Channel state for channel "publishpostupgrade1": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” publishpostupgrade1
16:25:10.340 Ably: Connection state: connecting
16:25:10.340 Ably: Channel state for channel "upgradepublish0": attaching
16:25:10.402 Ably: Connection state: connected
16:25:10.506 Ably: Channel state for channel "upgradepublish0": attached
16:25:10.528 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:10.528 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:25:10.528 Ably: Channel state for channel "upgradepublish0": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” upgradepublish0
16:25:10.540 Ably: Connection state: connecting
16:25:10.540 Ably: Channel state for channel "upgradepublish1": attaching
16:25:10.624 Ably: Connection state: connected
16:25:10.803 Ably: Channel state for channel "upgradepublish1": attached
16:25:10.827 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:10.827 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:25:10.827 Ably: Channel state for channel "upgradepublish1": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
âœ” upgradepublish1
16:25:10.840 Ably: Connection state: connecting
16:25:10.903 Ably: Connection state: connected
16:25:10.904 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:10.904 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
[31mâœ– upgradebase0[39m

Error: Expected 2 assertions, 1 ran
    at Object.done (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:121:25)
    at Object.test.done (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:143:22)
    at /mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:50:47
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:82:5)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at WebSocketTransport.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at WebSocketTransport.onWsClose (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:128:8)
    at WebSocket.wsConnection.onclose (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:68:48)
    at WebSocket.onClose (/mnt/terra/home/simon/ably/ably-js/node_modules/ws/lib/WebSocket.js:446:14)
    at emitTwo (events.js:106:13)
    at WebSocket.emit (events.js:191:7)
    at WebSocket.cleanupWebsocketResources (/mnt/terra/home/simon/ably/ably-js/node_modules/ws/lib/WebSocket.js:950:8)
    at emitNone (events.js:91:20)

16:25:10.921 Ably: Connection state: connecting
16:25:10.983 Ably: Connection state: connected
16:25:10.994 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:10.995 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” upgradeheartbeat0
16:25:11.8 Ably: Connection state: connecting
16:25:11.75 Ably: Connection state: connected
16:25:11.86 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:11.87 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” upgradeheartbeat1
16:25:11.99 Ably: Connection state: connecting
16:25:11.172 Ably: Connection state: connected
16:25:13.184 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:13.184 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” upgradeheartbeat2
16:25:13.196 Ably: Connection state: connecting
16:25:13.276 Ably: Connection state: connected
16:25:15.290 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:25:15.291 Ably: Connection state: closed; reason: Connection closed, code: 80017
Transport disposed; calling test.done()
âœ” upgradeheartbeat3
16:25:15.304 Ably: Connection state: connecting
16:25:15.357 Ably: Connection state: connected
[31mâœ– unrecoverableUpgrade[39m

Assertion Message: [35massert first transport to become active is a comet transport[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/realtime/upgrade.test.js:497:10)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at ConnectionManager.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at ConnectionManager.activateTransport (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:509:8)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:293:10)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at WebSocketTransport.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at WebSocketTransport.Transport.onProtocolMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/transport.js:87:9)
    at WebSocketTransport.onWsData (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:95:9)

Assertion Message: [35mTest timed out after 60s[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Timeout.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:146:14)
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)

Error: Expected 7 assertions, 3 ran
    at Object.done (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:121:25)
    at Object.test.done (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:143:22)
    at Timeout.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:147:14)
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)

16:26:15.313 Ably: Connection state: connecting
16:26:15.387 Ably: Connection state: connected
16:26:15.387 Ably: Channel state for channel "timeout0": attaching
16:26:15.568 Ably: Channel state for channel "timeout0": attached
16:26:15.569 Ably: EventEmitter.emit(): Unexpected listener exception: TypeError: Cannot read property 'code' of undefined; stack = TypeError: Cannot read property 'code' of undefined
    at /mnt/terra/home/simon/ably/ably-js/spec/realtime/upgrade.test.js:543:16
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/common/lib/client/realtimechannel.js:147:8)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at RealtimeChannel.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at RealtimeChannel.notifyState (/mnt/terra/home/simon/ably/ably-js/common/lib/client/realtimechannel.js:467:8)
    at RealtimeChannel.onMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/client/realtimechannel.js:307:10)
    at Channels.onChannelMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/client/realtime.js:53:11)
    at ConnectionManager.onChannelMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:1364:27)
    at WebSocketTransport.Transport.onProtocolMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/transport.js:128:27)
    at WebSocketTransport.onWsData (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:95:9)
    at WebSocket.wsConnection.onmessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:69:50)
    at WebSocket.onMessage (/mnt/terra/home/simon/ably/ably-js/node_modules/ws/lib/WebSocket.js:442:14)
    at emitTwo (events.js:106:13)
[31mâœ– attach_timeout_on_base_transport[39m

Assertion Message: [35mCheck first transport to become active is comet[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/realtime/upgrade.test.js:537:9)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at ConnectionManager.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at ConnectionManager.activateTransport (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:509:8)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:293:10)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at WebSocketTransport.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at WebSocketTransport.Transport.onProtocolMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/transport.js:87:9)
    at WebSocketTransport.onWsData (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:95:9)

Assertion Message: [35mTest timed out after 60s[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Timeout.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:146:14)
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)

16:27:15.320 Ably: Connection state: connecting
16:27:15.413 Ably: Connection state: connected
16:27:15.413 Ably: Channel state for channel "timeout1": attaching
16:27:15.599 Ably: Channel state for channel "timeout1": attached
16:27:15.616 Ably: Connection state: closing; reason: Connection closing, code: 80017
16:27:15.616 Ably: Connection state: closed; reason: Connection closed, code: 80017
16:27:15.617 Ably: Channel state for channel "timeout1": detached; reason: [ErrorInfo: Connection closed; statusCode=400; code=80017]
Transport disposed; calling test.done()
[31mâœ– message_timeout_stalling_upgrade[39m

Assertion Message: [35mCheck active transport is still comet[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at /mnt/terra/home/simon/ably/ably-js/spec/realtime/upgrade.test.js:572:10
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/common/lib/client/realtimechannel.js:147:8)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at RealtimeChannel.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at RealtimeChannel.notifyState (/mnt/terra/home/simon/ably/ably-js/common/lib/client/realtimechannel.js:467:8)
    at RealtimeChannel.onMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/client/realtimechannel.js:307:10)
    at Channels.onChannelMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/client/realtime.js:53:11)
    at ConnectionManager.onChannelMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:1364:27)
    at WebSocketTransport.Transport.onProtocolMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/transport.js:128:27)
    at WebSocketTransport.onWsData (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:95:9)
    at WebSocket.wsConnection.onmessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:69:50)
    at WebSocket.onMessage (/mnt/terra/home/simon/ably/ably-js/node_modules/ws/lib/WebSocket.js:442:14)

16:27:15.629 Ably: Connection state: connecting
16:27:15.732 Ably: Connection state: connected
[31mâœ– unresponsive_upgrade_sync[39m

Assertion Message: [35mTest timed out after 60s[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Timeout.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:146:14)
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)

Error: Expected 5 assertions, 2 ran
    at Object.done (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:121:25)
    at Object.test.done (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:143:22)
    at Timeout.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:147:14)
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)

16:28:15.630 Ably: Connection state: connecting
16:28:15.693 Ably: Connection state: connected
[31mâœ– persist_transport_prefs[39m

Assertion Message: [35mCheck first transport to become active is comet[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/realtime/upgrade.test.js:654:11)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at ConnectionManager.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at ConnectionManager.activateTransport (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:509:8)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:293:10)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at WebSocketTransport.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at WebSocketTransport.Transport.onProtocolMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/transport.js:87:9)
    at WebSocketTransport.onWsData (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:95:9)

Assertion Message: [35mTest timed out after 60s[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Timeout.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:146:14)
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)

16:29:15.631 Ably: Connection state: connecting
16:29:15.915 Ably: Connection state: connected
[31mâœ– upgrade_original_transport_dies[39m

Assertion Message: [35mCheck first transport to become active is comet[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/realtime/upgrade.test.js:696:11)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at ConnectionManager.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at ConnectionManager.activateTransport (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:509:8)
    at Object.<anonymous> (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/connectionmanager.js:293:10)
    at callListener (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:14:13)
    at /mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:164:4
    at Array.forEach (native)
    at Function.Utils.arrForEach.Array.forEach.len [as arrForEach] (/mnt/terra/home/simon/ably/ably-js/common/lib/util/utils.js:250:8)
    at WebSocketTransport.EventEmitter.emit (/mnt/terra/home/simon/ably/ably-js/common/lib/util/eventemitter.js:163:9)
    at WebSocketTransport.Transport.onProtocolMessage (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/transport.js:87:9)
    at WebSocketTransport.onWsData (/mnt/terra/home/simon/ably/ably-js/common/lib/transport/websockettransport.js:95:9)

Assertion Message: [35mTest timed out after 60s[39m
AssertionError: false == true
    at Object.ok (/mnt/terra/home/simon/ably/ably-js/node_modules/nodeunit/lib/types.js:83:39)
    at Timeout.<anonymous> (/mnt/terra/home/simon/ably/ably-js/spec/common/modules/shared_helper.js:146:14)
    at ontimeout (timers.js:365:14)
    at tryOnTimeout (timers.js:237:5)
    at Timer.listOnTimeout (timers.js:207:5)


[1mauth.test.js[22m
âœ” setupauth
âœ” authbase0
âœ” authbase1
âœ” authbase2
âœ” authtime0
16:30:16.145 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 401,
  code: 40101,
  message: 'Timestamp not current',
  serverId: 'frontend.22d0.1.eu-west-2-A.i-081baa3e75ac415b1' }
âœ” authtime1
âœ” authtime2
16:30:16.451 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 401,
  code: 40101,
  message: 'Nonce value replayed',
  serverId: 'frontend.22d0.1.eu-west-2-A.i-081baa3e75ac415b1' }
âœ” authnonce0
âœ” authclientid0
16:30:16.549 Ably: Auth.requestToken(): token request signing call returned error; err = [ErrorInfo: clientId canâ€™t be an empty string; statusCode=400; code=40012]
âœ” authemptyclientid
âœ” authcapability0
âœ” authkey0
âœ” authexplicit_simple
âœ” authexplicit_key
16:30:17.138 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 401,
  code: 40101,
  message: 'Request mac does not match',
  serverId: 'frontend.22d0.1.eu-west-2-A.i-081baa3e75ac415b1' }
âœ” authmac0
âœ” authdefaulttokenparams0
âœ” authdefaulttokenparams1
âœ” authauthorize
âœ” authttl0
16:30:17.683 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 400,
  code: 40003,
  message: 'Excessive value for ttl',
  serverId: 'frontend.22d0.1.eu-west-2-A.i-081baa3e75ac415b1' }
âœ” authttl1
16:30:17.782 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 400,
  code: 40003,
  message: 'Invalid value for ttl (-1)',
  serverId: 'frontend.aea2.1.eu-west-2-A.i-09a6af679d7326e29' }
âœ” authttl2
16:30:17.880 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 400,
  code: 40003,
  message: 'Invalid value for ttl (NaN)',
  serverId: 'frontend.4381.2.eu-west-2-A.i-081baa3e75ac415b1' }
âœ” authttl3
âœ” auth_createTokenRequest_given_key
âœ” auth_createTokenRequest_params0
âœ” auth_createTokenRequest_params1
âœ” auth_createTokenRequest_given_key2
âœ” auth_createTokenRequest_capability_object

[1mcapability.test.js[22m
âœ” setupcapability
âœ” authcapability0
âœ” authcapability1
16:30:18.204 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 401,
  code: 40160,
  message: 'Key does not support requested capabilities',
  serverId: 'frontend.22d0.1.eu-west-2-A.i-081baa3e75ac415b1' }
âœ” authcapability2
16:30:18.475 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 401,
  code: 40160,
  message: 'Key does not support requested capabilities',
  serverId: 'frontend.aea2.1.eu-west-2-A.i-09a6af679d7326e29' }
âœ” authcapability3
âœ” authcapability4
âœ” authcapability5
âœ” authcapability6
âœ” authcapability7
âœ” authcapability8
âœ” authcapability9
âœ” authcapability10
16:30:19.370 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 400,
  code: 40000,
  message: 'Malformed capability',
  serverId: 'frontend.ffbd.2.eu-west-2-A.i-09a6af679d7326e29' }
âœ” invalid0
16:30:19.468 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 400,
  code: 40000,
  message: 'Malformed capability',
  serverId: 'frontend.4381.2.eu-west-2-A.i-081baa3e75ac415b1' }
âœ” invalid1
16:30:19.567 Ably: Auth.requestToken(): token request API call returned error; err = { statusCode: 400,
  code: 40000,
  message: 'Malformed capability',
  serverId: 'frontend.aea2.1.eu-west-2-A.i-09a6af679d7326e29' }
âœ” invalid2

[1mdefaults.test.js[22m
âœ” defaults_no_opts
âœ” defaults_production
âœ” defaults_given_environment
âœ” defaults_local_ports
âœ” defaults_given_host
âœ” defaults_given_realtimehost
âœ” defaults_given_host_using_default_fallbacks
16:30:19.572 Ably: Deprecation warning - 'host' is deprecated and will be removed from a future version. Please use 'restHost' instead.
16:30:19.572 Ably: Deprecation warning - 'wsHost' is deprecated and will be removed from a future version. Please use 'realtimeHost' instead.
âœ” defaults_given_deprecated_host
âœ” defaults_set_default_environment

[1mhistory.test.js[22m
âœ” setup_history
âœ” history_simple
âœ” history_multiple
âœ” history_simple_paginated_b
âœ” history_simple_paginated_f
âœ” history_multiple_paginated_b
âœ” history_multiple_paginated_f
16:30:33.961 Ably: Message.fromResponseBody(): [ErrorInfo: Error processing the utf-8 encoding, decoder returned â€˜Expected input of utf8Decode to be a buffer or CryptoJS WordArrayâ€™; statusCode=400; code=40013]
âœ” history_encoding_errors

[1mhttp.test.js[22m
âœ” setupHttp
âœ” apiVersionHeader

[1minit.test.js[22m
âœ” setupInit
âœ” init_key_string
âœ” init_token_string
âœ” init_tls_false
âœ” init_tls_true
âœ” init_tls_absent
âœ” init_wildcard_clientId

[1mmessage.test.js[22m
âœ” setupInit
âœ” rest_implicit_client_id_0
âœ” rest_explicit_client_id_0
âœ” rest_explicit_client_id_1

[1mpresence.test.js[22m
âœ” setup_presence
âœ” presence_get_simple
âœ” presence_history_simple
âœ” presence_message_json_serialisation
âœ” presence_get_limits_and_filtering

[1mrequest.test.js[22m
âœ” setuptime
âœ” request_time
16:30:35.389 Ably: PaginatedResource.handlePage(): Unexpected error getting resource: err = {"statusCode":404,"code":40400,"message":"No application found with id ablyjs","serverId":"frontend.22d0.1.eu-west-2-A.i-081baa3e75ac415b1"}
âœ” request_404
âœ” request_post_get_messages

[1mstats.test.js[22m
Test App _tmp_a2l_MQ has been torn down
Test App _tmp_be20Kw in environment sandbox has been set up
âœ” setup_stats
âœ” appstats_minute0
âœ” appstats_minute1
âœ” appstats_hour0
âœ” appstats_day0
âœ” appstats_month0
âœ” appstats_limit_backwards
âœ” appstats_limit_forwards
âœ” appstats_pagination_backwards
âœ” appstats_pagination_forwards
âœ” appstats_pagination_omitted

[1mtime.test.js[22m
âœ” setuptime
âœ” time0

[1mtear_down.js[22m
Test App _tmp_be20Kw has been torn down
âœ” teardownapp

[1m[31mFAILURES: [39m[22m16/3103 assertions failed (729265ms)
[31m>> [39mNodeunit tests failed!
